<!DOCTYPE html>
<html lang="id">

<head>
  <meta charset="UTF-8">
  <title>Aplikasi Koperasi Sigap Nusantara</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- AOS Library -->
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
  <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>

  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            'poppins': ['Poppins', 'sans-serif']
          },
          colors: {
            'primary': '#FFD700',
            'secondary': '#FFC300',
            'accent': '#FFB347',
            'success': '#28a745',
            'warning': '#ffc107',
            'danger': '#dc3545',
            'info': '#17a2b8'
          }
        }
      }
    }
  </script>

  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #ffffff 0%, #FFD700 100%);
      min-height: 100vh;
    }

    .card-hover {
      transition: all 0.3s ease-in-out;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
    }

    .card-hover:hover {
      transform: translateY(-10px);
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
    }

    .btn-animated {
      position: relative;
      overflow: hidden;
      transition: all 0.3s ease;
    }

    .btn-animated::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
      transition: 0.5s;
    }

    .btn-animated:hover::before {
      left: 100%;
    }

    .pulse {
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0% {
        transform: scale(1);
        box-shadow: 0 0 0 0 rgba(255, 215, 0, 0.7);
      }

      70% {
        transform: scale(1.05);
        box-shadow: 0 0 0 15px rgba(255, 215, 0, 0);
      }

      100% {
        transform: scale(1);
        box-shadow: 0 0 0 0 rgba(255, 215, 0, 0);
      }
    }

    @media print {
      body * {
        visibility: hidden;
      }

      #outputSection,
      #outputSection * {
        visibility: visible;
      }

      #outputSection {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
      }
    }
  </style>
</head>

<body class="font-poppins">
  <!-- Navbar -->
  <nav class="bg-white shadow-lg" data-aos="fade-down">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between h-16">
        <div class="flex items-center">
          <div class="flex-shrink-0 flex items-center">
            <i class="fas fa-building text-yellow-500 text-2xl mr-2"></i>
            <span class="font-bold text-xl text-gray-800">Koperasi Sigap</span>
          </div>
        </div>
        <div class="hidden md:flex items-center space-x-4">
        </div>
      </div>
    </div>
  </nav>

  <!-- Hero Section -->
  <div class="py-20 px-4 bg-gradient-to-r from-yellow-100 to-yellow-300" id="heroSection">
    <div class="max-w-4xl mx-auto text-center text-gray-800" data-aos="zoom-in">
      <h1 class="text-4xl md:text-6xl font-bold mb-6">SERAGAM KOPERASI SIGAP</h1>
           <button onclick="startApplication()" id="startButton"
        class="btn-animated bg-gradient-to-r from-yellow-400 to-yellow-500 hover:from-yellow-500 hover:to-yellow-600 text-white font-bold py-4 px-8 rounded-full text-lg shadow-xl pulse">
        <i class="fas fa-rocket mr-2"></i>Mulai Sekarang
      </button>
    </div>
  </div>

  <!-- Landing Page -->
  <div class="container mx-auto max-w-6xl py-16 px-4" id="landingPage" style="display: none;">
    <div class="text-center mb-16" data-aos="fade-up" id="menuSection">
      <h2 class="text-3xl font-bold text-gray-800 mb-8">Silakan pilih menu di bawah:</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
        <button onclick="navigateTo('box-search')"
          class="btn-animated bg-gradient-to-r from-yellow-400 to-yellow-500 hover:from-yellow-500 hover:to-yellow-600 text-white font-bold py-5 px-6 rounded-xl shadow-lg flex flex-col items-center justify-center transition-all duration-300 transform hover:scale-105">
          <i class="fas fa-search text-3xl mb-3"></i>
          <span class="text-lg">Cari Data PO</span>
        </button>

        <button onclick="navigateTo('box-seragam')"
          class="btn-animated bg-gradient-to-r from-yellow-500 to-yellow-600 hover:from-yellow-600 hover:to-yellow-700 text-white font-bold py-5 px-6 rounded-xl shadow-lg flex flex-col items-center justify-center transition-all duration-300 transform hover:scale-105">
          <i class="fas fa-file-invoice text-3xl mb-3"></i>
          <span class="text-lg">Input Data Seragam</span>
        </button>

        <button onclick="navigateTo('box-po')"
          class="btn-animated bg-gradient-to-r from-yellow-600 to-yellow-700 hover:from-yellow-700 hover:to-yellow-800 text-white font-bold py-5 px-6 rounded-xl shadow-lg flex flex-col items-center justify-center transition-all duration-300 transform hover:scale-105">
          <i class="fas fa-receipt text-3xl mb-3"></i>
          <span class="text-lg">Input PO_Seragam</span>
        </button>

        <button onclick="navigateTo('box-surat')"
          class="btn-animated bg-gradient-to-r from-yellow-700 to-yellow-800 hover:from-yellow-800 hover:to-yellow-900 text-white font-bold py-5 px-6 rounded-xl shadow-lg flex flex-col items-center justify-center transition-all duration-300 transform hover:scale-105">
          <i class="fas fa-truck text-3xl mb-3"></i>
          <span class="text-lg">Buat Surat Jalan</span>
        </button>
      </div>
    </div>
  </div>

  <!-- Semua Form -->
  <div class="container mx-auto max-w-4xl py-16 px-4" id="formContainer" style="display: none;">

    <!-- Form Cari Data PO -->
    <div class="bg-white rounded-2xl shadow-2xl p-8 mb-10" id="box-search" style="display: none;" data-aos="fade-up">
      <div class="flex items-center mb-6">
        <i class="fas fa-search text-yellow-500 text-2xl mr-3"></i>
        <h2 class="text-2xl font-bold text-gray-800">Cari Data PO</h2>
      </div>

      <div id="notif-search" class="text-center font-bold mb-6 p-3 rounded-lg"></div>

      <form id="form-search" class="space-y-6">
        <div>
          <label class="block text-gray-700 font-semibold mb-2">Nomor PO:</label>
          <div class="relative">
            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
              <i class="fas fa-hashtag text-gray-400"></i>
            </div>
            <input type="text" name="search_po" required
              class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-yellow-500 focus:border-transparent shadow-sm">
          </div>
        </div>

        <button type="submit"
          class="w-full bg-gradient-to-r from-yellow-400 to-yellow-500 hover:from-yellow-500 hover:to-yellow-600 text-white font-bold py-3 px-4 rounded-xl shadow-lg transition-all duration-300 transform hover:scale-105">
          <i class="fas fa-search mr-2"></i> Cari PO
        </button>
      </form>

      <div id="search-results" class="mt-8 space-y-4"></div>

      <button
        class="mt-8 w-full bg-gradient-to-r from-gray-500 to-gray-600 hover:from-gray-600 hover:to-gray-700 text-white font-bold py-3 px-4 rounded-xl shadow-lg transition-all duration-300 flex items-center justify-center"
        onclick="backToHome()">
        <i class="fas fa-arrow-left mr-2"></i> Kembali ke Menu Awal
      </button>
    </div>

    <!-- Form Data Seragam -->
    <div class="bg-white rounded-2xl shadow-2xl p-8 mb-10" id="box-seragam" style="display: none;" data-aos="fade-up">
      <div class="flex items-center mb-6">
        <i class="fas fa-file-invoice text-yellow-500 text-2xl mr-3"></i>
        <h2 class="text-2xl font-bold text-gray-800">Form Data Seragam</h2>
      </div>

      <div id="notif-seragam" class="text-center font-bold mb-6 p-3 rounded-lg"></div>

      <form id="form-seragam" class="space-y-6">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <label class="block text-gray-700 font-semibold mb-2">Tanggal:</label>
            <div class="relative">
              <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                <i class="fas fa-calendar-alt text-gray-400"></i>
              </div>
              <input type="date" name="tanggal" required
                class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-yellow-500 focus:border-transparent shadow-sm">
            </div>
          </div>

          <div>
            <label class="block text-gray-700 font-semibold mb-2">No. Invoice:</label>
            <div class="relative">
              <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                <i class="fas fa-file-invoice text-gray-400"></i>
              </div>
              <input type="text" name="no_inv" required
                class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-yellow-500 focus:border-transparent shadow-sm">
            </div>
          </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <label class="block text-gray-700 font-semibold mb-2">No. PO:</label>
            <div class="relative">
              <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                <i class="fas fa-receipt text-gray-400"></i>
              </div>
              <input type="text" name="no_po" required
                class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-yellow-500 focus:border-transparent shadow-sm">
            </div>
          </div>

          <div>
            <label class="block text-gray-700 font-semibold mb-2">Nominal:</label>
            <div class="relative">
              <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                <i class="fas fa-money-bill-wave text-gray-400"></i>
              </div>
              <input type="number" name="nominal" required
                class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-yellow-500 focus:border-transparent shadow-sm">
            </div>
          </div>
        </div>

        <div>
          <label class="block text-gray-700 font-semibold mb-2">User:</label>
          <div class="relative">
            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
              <i class="fas fa-user text-gray-400"></i>
            </div>
            <input type="text" name="user" required
              class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-yellow-500 focus:border-transparent shadow-sm">
          </div>
        </div>

        <button type="submit"
          class="w-full bg-gradient-to-r from-yellow-500 to-yellow-600 hover:from-yellow-600 hover:to-yellow-700 text-white font-bold py-3 px-4 rounded-xl shadow-lg transition-all duration-300 transform hover:scale-105">
          <i class="fas fa-paper-plane mr-2"></i> Kirim Data Seragam
        </button>
      </form>

      <button
        class="mt-8 w-full bg-gradient-to-r from-gray-500 to-gray-600 hover:from-gray-600 hover:to-gray-700 text-white font-bold py-3 px-4 rounded-xl shadow-lg transition-all duration-300 flex items-center justify-center"
        onclick="backToHome()">
        <i class="fas fa-arrow-left mr-2"></i> Kembali ke Menu Awal
      </button>
    </div>

    <!-- Form Data PO_Seragam -->
    <div class="bg-white rounded-2xl shadow-2xl p-8 mb-10" id="box-po" style="display: none;" data-aos="fade-up">
      <div class="flex items-center mb-6">
        <i class="fas fa-receipt text-yellow-600 text-2xl mr-3"></i>
        <h2 class="text-2xl font-bold text-gray-800">Form Data PO_Seragam</h2>
      </div>

      <div id="notif-po" class="text-center font-bold mb-6 p-3 rounded-lg"></div>

      <form id="form-po" class="space-y-6">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <label class="block text-gray-700 font-semibold mb-2">Tanggal:</label>
            <div class="relative">
              <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                <i class="fas fa-calendar-alt text-gray-400"></i>
              </div>
              <input type="date" name="tanggal" required
                class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-yellow-600 focus:border-transparent shadow-sm">
            </div>
          </div>

          <div>
            <label class="block text-gray-700 font-semibold mb-2">No. BK:</label>
            <div class="relative">
              <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                <i class="fas fa-file-alt text-gray-400"></i>
              </div>
              <input type="text" name="no_bk" required
                class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-yellow-600 focus:border-transparent shadow-sm">
            </div>
          </div>
        </div>

        <div>
          <label class="block text-gray-700 font-semibold mb-2">No. PO:</label>
          <div class="relative">
            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
              <i class="fas fa-receipt text-gray-400"></i>
            </div>
            <input type="text" name="no_po" required
              class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-yellow-600 focus:border-transparent shadow-sm">
          </div>
        </div>

        <button type="submit"
          class="w-full bg-gradient-to-r from-yellow-600 to-yellow-700 hover:from-yellow-700 hover:to-yellow-800 text-white font-bold py-3 px-4 rounded-xl shadow-lg transition-all duration-300 transform hover:scale-105">
          <i class="fas fa-paper-plane mr-2"></i> Kirim Data PO_Seragam
        </button>
      </form>

      <button
        class="mt-8 w-full bg-gradient-to-r from-gray-500 to-gray-600 hover:from-gray-600 hover:to-gray-700 text-white font-bold py-3 px-4 rounded-xl shadow-lg transition-all duration-300 flex items-center justify-center"
        onclick="backToHome()">
        <i class="fas fa-arrow-left mr-2"></i> Kembali ke Menu Awal
      </button>
    </div>

    <!-- Form Surat Jalan -->
    <div class="bg-white rounded-2xl shadow-2xl p-8 mb-10" id="box-surat" style="display: none;" data-aos="fade-up">
      <div class="flex items-center mb-6">
        <i class="fas fa-truck text-yellow-700 text-2xl mr-3"></i>
        <h2 class="text-2xl font-bold text-gray-800">Form Input Surat Jalan</h2>
      </div>

      <form id="suratForm" class="space-y-6">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <label class="block text-gray-700 font-semibold mb-2">Nomor Surat</label>
            <div class="relative">
              <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                <i class="fas fa-hashtag text-gray-400"></i>
              </div>
              <input type="text" name="nomor" required
                class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-yellow-700 focus:border-transparent shadow-sm">
            </div>
          </div>

          <div>
            <label class="block text-gray-700 font-semibold mb-2">Tanggal</label>
            <div class="relative">
              <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                <i class="fas fa-calendar-alt text-gray-400"></i>
              </div>
              <input type="date" name="tanggal" required
                class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-yellow-700 focus:border-transparent shadow-sm">
            </div>
          </div>
        </div>

        <div>
          <label class="block text-gray-700 font-semibold mb-2">User</label>
          <div class="relative">
            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
              <i class="fas fa-user text-gray-400"></i>
            </div>
            <input type="text" name="user" required
              class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-yellow-700 focus:border-transparent shadow-sm">
          </div>
        </div>

        <div>
          <label class="block text-gray-700 font-semibold mb-2">Jumlah Barang</label>
          <div class="relative">
            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
              <i class="fas fa-boxes text-gray-400"></i>
            </div>
            <input type="number" name="jumlahBarang" min="1" required
              class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-yellow-700 focus:border-transparent shadow-sm">
          </div>
        </div>

        <button type="button" onclick="buatInputBarang()"
          class="w-full bg-gradient-to-r from-yellow-400 to-yellow-500 hover:from-yellow-500 hover:to-yellow-600 text-white font-bold py-3 px-4 rounded-xl shadow-lg transition-all duration-300">
          <i class="fas fa-plus-circle mr-2"></i> Buat Form Barang
        </button>

        <div id="barangInputs" class="space-y-6"></div>

        <button type="submit"
          class="w-full bg-gradient-to-r from-yellow-700 to-yellow-800 hover:from-yellow-800 hover:to-yellow-900 text-white font-bold py-3 px-4 rounded-xl shadow-lg transition-all duration-300">
          <i class="fas fa-file-contract mr-2"></i> Tampilkan Surat Jalan
        </button>
      </form>

      <div class="text-center mt-8">
        <button id="printButton" onclick="printSurat()"
          class="hidden bg-gradient-to-r from-yellow-600 to-yellow-700 hover:from-yellow-700 hover:to-yellow-800 text-white font-bold py-3 px-6 rounded-xl shadow-lg transition-all duration-300">
          <i class="fas fa-print mr-2"></i> Cetak / Simpan PDF
        </button>
      </div>

      <div id="outputSection" class="mt-10 p-6 bg-yellow-50 rounded-xl border border-yellow-200">
        <div id="output"></div>
      </div>

      <button
        class="mt-8 w-full bg-gradient-to-r from-gray-500 to-gray-600 hover:from-gray-600 hover:to-gray-700 text-white font-bold py-3 px-4 rounded-xl shadow-lg transition-all duration-300 flex items-center justify-center"
        onclick="backToHome()">
        <i class="fas fa-arrow-left mr-2"></i> Kembali ke Menu Awal
      </button>
    </div>
  </div>

  <!-- Footer Baru (Sederhana) -->
  <footer class="bg-gray-800 text-white py-8">
    <div class="container mx-auto max-w-6xl px-4 text-center">
      <p class="text-gray-400">&copy; 2023 Koperasi Sigap Nusantara. Hak Cipta Dilindungi.</p>
    </div>
  </footer>

  <script>
    // Inisialisasi AOS
    document.addEventListener('DOMContentLoaded', function () {
      AOS.init({
        duration: 1000,
        easing: 'ease-out-cubic',
        once: true
      });
    });

    function startApplication() {
      // Sembunyikan tombol Mulai Sekarang
      document.getElementById('startButton').style.display = 'none';
      // Perkecil hero section
      document.getElementById('heroSection').classList.add('py-10');
      // Tampilkan menu utama
      document.getElementById('landingPage').style.display = 'block';
      // Scroll ke menu
      document.getElementById('menuSection').scrollIntoView({ behavior: 'smooth' });
    }

    // Updated script URL
    const scriptURL = "https://script.google.com/macros/s/AKfycbx7br5nZCfXW9xXqY2kZxhg72WxTsxYRAwNoH_UG2NGRo2_JPetYSMklLwmUYuMPT6M/exec";

    function navigateTo(formId) {
      document.getElementById("landingPage").style.display = "none";
      document.getElementById("formContainer").style.display = "block";
      const sections = ["box-search", "box-seragam", "box-po", "box-surat"];
      sections.forEach(id => document.getElementById(id).style.display = "none");
      document.getElementById(formId).style.display = "block";
      // Scroll to top
      window.scrollTo({ top: 0, behavior: 'smooth' });
      // Refresh AOS setelah navigasi
      AOS.refresh();
    }

    function backToHome() {
      document.getElementById("formContainer").style.display = "none";
      document.getElementById("landingPage").style.display = "block";
      // Scroll to menu section
      document.getElementById("menuSection").scrollIntoView({ behavior: 'smooth' });
    }

    document.getElementById('form-seragam').addEventListener('submit', async function (e) {
      e.preventDefault();
      const notif = document.getElementById('notif-seragam');
      const formData = new FormData(e.target);
      try {
        await fetch(scriptURL, { method: "POST", body: formData });
        notif.textContent = "‚úÖ Data Seragam berhasil dikirim!";
        notif.className = "text-center font-bold mb-6 p-3 rounded-lg bg-green-100 text-green-700";
        e.target.reset();
      } catch (err) {
        notif.textContent = "‚ùå Gagal mengirim data.";
        notif.className = "text-center font-bold mb-6 p-3 rounded-lg bg-red-100 text-red-700";
      }
    });

    document.getElementById('form-po').addEventListener('submit', async function (e) {
      e.preventDefault();
      const notif = document.getElementById('notif-po');
      const formData = new FormData(e.target);
      try {
        await fetch(scriptURL, { method: "POST", body: formData });
        notif.textContent = "‚úÖ Data PO_Seragam berhasil dikirim!";
        notif.className = "text-center font-bold mb-6 p-3 rounded-lg bg-green-100 text-green-700";
        e.target.reset();
      } catch (err) {
        notif.textContent = "‚ùå Gagal mengirim data.";
        notif.className = "text-center font-bold mb-6 p-3 rounded-lg bg-red-100 text-red-700";
      }
    });

    document.getElementById('form-search').addEventListener('submit', async function (e) {
      e.preventDefault();
      const notif = document.getElementById('notif-search');
      const resultsContainer = document.getElementById('search-results');
      const formData = new FormData(e.target);
      notif.textContent = "üîç Mencari data...";
      notif.className = "text-center font-bold mb-6 p-3 rounded-lg bg-blue-100 text-blue-700";
      resultsContainer.innerHTML = "";
      try {
        const response = await fetch(scriptURL, { method: "POST", body: formData });
        const result = await response.json();
        if (result.status === "success") {
          notif.textContent = `‚úÖ Ditemukan ${result.count} data`;
          notif.className = "text-center font-bold mb-6 p-3 rounded-lg bg-green-100 text-green-700";
          result.data.forEach(item => {
            const div = document.createElement("div");
            div.className = "bg-gray-50 p-5 rounded-xl border border-gray-200 shadow-sm";
            div.innerHTML = 
                `<div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                  <div><strong class="text-gray-700">No:</strong> <span class="text-gray-900">${item.no || "-"}</span></div>
                  <div><strong class="text-gray-700">Tanggal:</strong> <span class="text-gray-900">${item.tanggal || "-"}</span></div>
                  <div><strong class="text-gray-700">No. Invoice:</strong> <span class="text-gray-900">${item.no_inv || "-"}</span></div>
                  <div><strong class="text-gray-700">No. PO:</strong> <span class="text-gray-900">${item.no_po || "-"}</span></div>
                  <div><strong class="text-gray-700">Nominal:</strong> <span class="text-gray-900">${item.nominal ? Number(item.nominal).toLocaleString() : "-"}</span></div>
                  <div><strong class="text-gray-700">DPP:</strong> <span class="text-gray-900">${item.dpp ? Number(item.dpp).toLocaleString() : "-"}</span></div>
                  <div><strong class="text-gray-700">DPP9:</strong> <span class="text-gray-900">${item.dpp9 ? Number(item.dpp9).toLocaleString() : "-"}</span></div>
                  <div><strong class="text-gray-700">User:</strong> <span class="text-gray-900">${item.user || "-"}</span></div>
                </div>`;
            resultsContainer.appendChild(div);
          });
        } else {
          notif.textContent = result.message || "‚ùå Tidak ditemukan.";
          notif.className = "text-center font-bold mb-6 p-3 rounded-lg bg-red-100 text-red-700";
        }
      } catch (err) {
        notif.textContent = "‚ùå Gagal melakukan pencarian.";
        notif.className = "text-center font-bold mb-6 p-3 rounded-lg bg-red-100 text-red-700";
      }
    });

    function buatInputBarang() {
      const jumlah = document.querySelector('input[name="jumlahBarang"]').value;
      const container = document.getElementById('barangInputs');
      container.innerHTML = "";
      for (let i = 1; i <= jumlah; i++) {
        container.innerHTML += 
            `<div class="bg-yellow-50 p-5 rounded-xl border border-yellow-200">
              <h3 class="font-bold text-yellow-700 mb-3 flex items-center">
                <i class="fas fa-box mr-2"></i> Barang ${i}
              </h3>
              <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="md:col-span-2">
                  <label class="block text-sm font-medium text-gray-700 mb-1">Nama Barang ${i}</label>
                  <input type="text" name="barang${i}" required
                         class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent">
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">Qty ${i}</label>
                  <input type="number" name="qty${i}" required
                         class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent">
                </div>
              </div>
              <div class="mt-3">
                <label class="block text-sm font-medium text-gray-700 mb-1">Satuan ${i}</label>
                <select name="satuan${i}"
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent">
                  <option value="pcs">pcs</option>
                  <option value="stel">stel</option>
                  <option value="psg">psg</option>
                </select>
              </div>
            </div>`;
      }
    }

    // Fungsi untuk membuka jendela cetak dengan data dinamis
    function openPrintWindow(suratData) {
      const printWindow = window.open('', '_blank');
      const printDocument = printWindow.document;

      // Menulis konten HTML ke jendela baru, mengganti placeholder dengan data
      printDocument.write(
          `<!DOCTYPE html>
          <html lang="en">
          <head>
              <meta charset="UTF-8">
              <meta name="viewport" content="width=device-width, initial-scale=1.0">
              <title>Surat Jalan</title>
              <style>
                  body {
                      font-family: Arial, sans-serif;
                      margin: 20px;
                  }
                  .container {
                      display: flex;
                      justify-content: space-between;
                      align-items: flex-start;
                  }
                  .header {
                      font-weight: bold;
                  }
                  .header-koperasi {
                      font-weight: bold;
                  }
                  .alamat {
                      font-style: italic;
                  }
                  .center {
                      text-align: center;
                  }
                  .right {
                      text-align: right;
                  }
                  .signature {
                      text-align: center;
                      margin-top: 20px;
                  }
                  .section-gap {
                      margin-bottom: 10px;
                  }
                  .item-gap {
                      margin-top: 10px;
                  }
                  .koperasi, .surat-jalan {
                      width: 48%;
                      padding: 10px;
                  }
                  .surat-jalan {
                      border: 1px solid black;
                  }
                  table {
                      width: 100%;
                      border-collapse: collapse;
                      margin-top: 20px;
                  }
                  th, td {
                      border: 1px solid black;
                      padding: 8px;
                      text-align: left;
                  }
                  th {
                      background-color: #f2f2f2;
                  }
                  .signature-block td {
                      height: 100px;
                      vertical-align: bottom;
                      text-align: center;
                  }
              </style>
          </head>
          <body>
              <div class="container section-gap">
                  <div class="koperasi">
                      <div class="header-koperasi">Koperasi Sigap Nusantara</div>
                      <div>Jl. A. Yani No. 66, RW. 3, Cemp. Putih Timur</div>
                      <div>Kota Jakarta Pusat - 10510</div>
                      <div>(021) 21242525<br>NPWP: 02.250.480.7-408.000</div>
                  </div>
                  <div class="surat-jalan">
                      <p class="header center">Surat Jalan</p>
                      <p style="display: flex; justify-content: space-between; margin: 5px 0;">
                          <span style="width: 70px;">Nomor</span>
                          <span>:</span>
                          <span style="flex: 1; margin-left: 10px;">${suratData.nomor}/SRT/SPA/VII/2025</span>
                      </p>
                      <p style="display: flex; justify-content: space-between; margin: 5px 0;">
                          <span style="width: 70px;">Tanggal</span>
                          <span>:</span>
                          <span style="flex: 1; margin-left: 10px;">${suratData.tanggal}</span>
                      </p>
                      <p style="display: flex; justify-content: space-between; margin: 5px 0;">
                          <span style="width: 70px;">User</span>
                          <span>:</span>
                          <span style="flex: 1; margin-left: 10px;">${suratData.user}</span>
                      </p>
                      <p style="display: flex; justify-content: space-between; margin: 5px 0;">
                          <span style="width: 70px;">No PO</span>
                          <span>:</span>
                          <span style="flex: 1; margin-left: 10px;">${suratData.no_po || ''}</span>
                      </p>
                      <p style="display: flex; justify-content: space-between; margin: 5px 0;">
                          <span style="width: 70px;">Penerima</span>
                          <span>:</span>
                          <span style="flex: 1; margin-left: 10px;"></span>
                      </p>
                  </div>
              </div>
  
              <table style="width: 30%; border-collapse: collapse; border: 1px solid black; margin-top: 20px;">
                  <tr>
                      <td colspan="4" class="alamat center" style="border: 1px solid black; padding: 5px;">Alamat Pengiriman</td>
                  </tr>
                  <tr>
                      <td colspan="4" style="font-weight: bold; border: 1px solid black; padding: 5px;">PT. Sigap Prima Astrea</td>
                  </tr>
                  <tr>
                      <td colspan="4" style="border: 1px solid black; padding: 5px;">Jl. A. Yani No. 66, RW. 3,<br>Cemp. Putih Tim., Kec. Cemp. Putih,</td>
                  </tr>
                  <tr>
                      <td colspan="4" style="border: 1px solid black; padding: 5px;">Kota Jakarta Pusat - 10510</td>
                  </tr>
              </table>
  
              <table style="width: 100%; border-collapse: collapse; border: 1px solid black; margin-top: 20px;">
                  <tr>
                      <td colspan="5" style="border: 1px solid black; padding: 5px;">Harap dikirimkan barang-barang berikut ini:</td>
                  </tr>
                  <tr>
                      <th style="border: 1px solid black; padding: 5px; background-color: #f2f2f2;">No.</th>
                      <th colspan="2" style="border: 1px solid black; padding: 5px; background-color: #f2f2f2;">Nama Barang</th>
                      <th style="border: 1px solid black; padding: 5px; background-color: #f2f2f2;">Qty</th>
                      <th style="border: 1px solid black; padding: 5px; background-color: #f2f2f2;">Satuan</th>
                  </tr>
                  ${suratData.rows}
                  <tr>
              <td colspan="2" style="border: 1px solid black; padding: 5px; text-align: center; font-weight: bold;">
                  Disiapkan oleh</td>
              <td style="border: 1px solid black; padding: 5px; text-align: center; font-weight: bold;">Disetujui oleh
              </td>
              <td></td>
              <td style="border: 1px solid black; padding: 5px; text-align: center; font-weight: bold;">Dikonfirmasi oleh
              </td>
          </tr>
          <tr style="font-weight: bold;">
              <td colspan="2" class="signature" style="border: 1px solid black; padding: 5px; text-align: center;">
                  <br><br><br><br><br>Steven
                  Jefferson<br><span style="font-size: smaller;">Staff Koperasi</span>
              </td>
              <td class="signature" style="border: 1px solid black; padding: 5px; text-align: center;">
                  <br><br><br><br><br>Agus
                  Sofyan
                  Effendi<br><span style="font-size: smaller;">Manager Koperasi</span>
              </td>
              <td></td>
              <td class="signature" style="border: 1px solid black; padding: 5px; text-align: center;">
                  <br><br><br><br><br>Customer
              </td>
          </tr>
              </table>
  
              <script>
                window.onload = function() {
                  setTimeout(function() {
                    window.print();
                  }, 500);
                }
              <\/script>
          </body>
          </html>`
        );

      printDocument.close();
    }

    function printSurat() {
      const form = document.querySelector('#box-surat form');
      if (!form) {
        alert("Form Surat Jalan tidak ditemukan!");
        return;
      }

      const nomor = form.nomor.value;
      const tanggalInput = form.tanggal.value;
      const user = form.user.value;
      const no_po = form.no_po ? form.no_po.value : "";
      const jumlah = parseInt(form.jumlahBarang.value);

      if (!nomor || !tanggalInput || !user || isNaN(jumlah) || jumlah <= 0) {
        alert("Harap isi semua field yang diperlukan dan buat form barang terlebih dahulu.");
        return;
      }

      let tanggalFormatted = "";
      if (tanggalInput) {
        const tanggalObj = new Date(tanggalInput);
        tanggalFormatted = tanggalObj.toLocaleDateString('id-ID', { day: '2-digit', month: 'short', year: 'numeric' });
      }

      let rows = "";
      for (let i = 1; i <= jumlah; i++) {
        const namaInput = form[`barang${i}`];
        const qtyInput = form[`qty${i}`];
        const satuanInput = form[`satuan${i}`];

        if (namaInput && qtyInput && satuanInput) {
          const nama = namaInput.value;
          const qty = qtyInput.value;
          const satuan = satuanInput.value;
          rows += `<tr>
                       <td style="border: 1px solid black; padding: 5px;">${i}</td>
                       <td colspan="2" style="border: 1px solid black; padding: 5px;">${nama}</td>
                       <td style="border: 1px solid black; padding: 5px;">${qty}</td>
                       <td style="border: 1px solid black; padding: 5px;">${satuan}</td>
                     </tr>`;
        } else {
          console.warn(`Input barang ${i} tidak ditemukan atau tidak lengkap.`);
        }
      }

      const suratData = {
        nomor: nomor,
        tanggal: tanggalFormatted,
        user: user,
        no_po: no_po,
        rows: rows
      };

      openPrintWindow(suratData);
    }

    document.getElementById("suratForm").addEventListener("submit", function (e) {
      e.preventDefault();
      const form = e.target;
      const nomor = form.nomor.value;
      const tanggal = form.tanggal.value;
      const user = form.user.value;
      let noPoInput = form.querySelector('input[name="no_po"]');
      if (!noPoInput) {
        noPoInput = document.createElement('input');
        noPoInput.type = 'hidden';
        noPoInput.name = 'no_po';
        form.appendChild(noPoInput);
      }
      const no_po = noPoInput.value;

      const jumlah = parseInt(form.jumlahBarang.value);
      let rows = "";
      for (let i = 1; i <= jumlah; i++) {
        const nama = form[`barang${i}`].value;
        const qty = form[`qty${i}`].value;
        const satuan = form[`satuan${i}`].value;
        rows += `<tr><td class="border border-gray-400 p-2">${i}</td><td class="border border-gray-400 p-2">${nama}</td><td class="border border-gray-400 p-2">${qty}</td><td class="border border-gray-400 p-2">${satuan}</td></tr>`;
      }
      document.getElementById("output").innerHTML = 
          `<div class="bg-white p-6 rounded-xl shadow-lg">
            <table class="w-full border-collapse border border-gray-400">
              <tr>
                <td colspan="2" class="border border-gray-400 p-4 align-top">
                  <strong class="text-lg text-yellow-600">Koperasi Sigap Nusantara</strong><br>
                  <div class="mt-2 text-gray-700">
                    Jl. A. Yani No.66, RW.3, Cemp. Putih Timur<br>
                    Kota Jakarta Pusat - 10510<br>
                    (021) 2124525<br>
                    NPWP: 02.250.480.7-408.000
                  </div>
                </td>
                <td colspan="2" class="border border-gray-400 p-4 text-right align-top">
                  <strong class="text-lg text-yellow-700">Surat Jalan</strong><br><br>
                  <div class="text-gray-700">
                    Nomor: ${nomor}<br>
                    Tanggal: ${tanggal}<br>
                    User: ${user}<br>
                    No PO: ${no_po || '-'}
                  </div>
                </td>
              </tr>
              <tr>
                <td colspan="4" class="border border-gray-400 p-4 bg-yellow-50">
                  <strong class="text-yellow-700">Alamat Pengiriman</strong><br>
                  <div class="mt-2 text-gray-700">
                    PT. Sigap Prima Astrea<br>
                    Jl. A. Yani No.66, RW.3, Cemp. Putih Tim., Kec. Cemp. Putih,<br>
                    Kota Jakarta Pusat - 10510
                  </div>
                </td>
              </tr>
              <tr>
                <td colspan="4" class="border border-gray-400 p-4">
                  Harap dikirimkan barang-barang berikut ini:
                </td>
              </tr>
              <tr>
                <th class="border border-gray-400 p-2 bg-gray-100">No.</th>
                <th class="border border-gray-400 p-2 bg-gray-100">Nama Barang</th>
                <th class="border border-gray-400 p-2 bg-gray-100">Qty</th>
                <th class="border border-gray-400 p-2 bg-gray-100">Satuan</th>
              </tr>
              ${rows}
              <tr class="signature-block">
                <td class="border border-gray-400 p-4 h-32 align-bottom text-center">
                  <div class="text-gray-700">Disiapkan oleh</div><br><br>
                  <strong class="text-yellow-600">Steven Jefferson</strong><br>
                  <span class="text-sm text-gray-600">Staff Koperasi</span>
                </td>
                <td class="border border-gray-400 p-4 h-32 align-bottom text-center">
                  <div class="text-gray-700">Disetujui oleh</div><br><br>
                  <strong class="text-yellow-600">Agus Sofyan Effendi</strong><br>
                  <span class="text-sm text-gray-600">Manager Koperasi</span>
                </td>
                <td colspan="2" class="border border-gray-400 p-4 h-32 align-bottom text-center">
                  <div class="text-gray-700">Dikonfirmasi oleh</div><br><br>
                  <strong class="text-gray-700">________________________</strong><br>
                  <span class="text-sm text-gray-600">Customer</span>
                </td>
              </tr>
            </table>
          </div>`;
      document.getElementById("outputSection").style.display = "block";
      document.getElementById("printButton").style.display = "inline-block";
      document.getElementById("outputSection").scrollIntoView({ behavior: 'smooth' });
    });
  </script>
</body>
</html>