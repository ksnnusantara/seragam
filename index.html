<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <title>Aplikasi Koperasi Sigap Nusantara</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'poppins': ['Poppins', 'sans-serif']
                    },
                    colors: {
                        'primary': '#FFD700',
                        'secondary': '#FFC300',
                        'accent': '#FFB347',
                        'success': '#10B981',
                        'warning': '#F59E0B',
                        'danger': '#EF4444',
                        'info': '#3B82F6'
                    },
                    boxShadow: {
                        'soft': '0 2px 15px -3px rgba(0, 0, 0, 0.07), 0 10px 20px -2px rgba(0, 0, 0, 0.04)',
                        'medium': '0 4px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 30px -5px rgba(0, 0, 0, 0.04)',
                        'large': '0 10px 40px -10px rgba(0, 0, 0, 0.15), 0 20px 50px -15px rgba(0, 0, 0, 0.1)'
                    }
                }
            }
        }
    </script>

    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #FFF8DC 0%, #FFD700 50%, #FFC300 100%);
            min-height: 100vh;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background:
                radial-gradient(circle at 20% 80%, rgba(255, 215, 0, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 195, 0, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(255, 179, 71, 0.2) 0%, transparent 50%);
            z-index: -1;
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .btn-animated {
            position: relative;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            transform: translateY(0);
        }

        .btn-animated::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            transition: 0.6s;
        }

        .btn-animated:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        }

        .btn-animated:hover::before {
            left: 100%;
        }

        .card-hover {
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            transform: translateY(0);
        }

        .card-hover:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
        }

        .selection-card {
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 215, 0, 0.2);
        }

        .selection-card:hover {
            transform: translateY(-10px) scale(1.03);
            box-shadow: 0 20px 40px rgba(255, 215, 0, 0.3);
            border-color: rgba(255, 215, 0, 0.4);
        }

        .selection-card .icon-container {
            background: linear-gradient(135deg, #FFD700, #FFC300);
            transition: all 0.4s ease;
        }

        .selection-card:hover .icon-container {
            background: linear-gradient(135deg, #FFC300, #FFB347);
            transform: scale(1.1) rotate(-5deg);
        }

        /* Custom HP Type Select Styling */
        .hp-select-container {
            position: relative;
            max-width: 100%;
        }

        .select2-container {
            width: 100% !important;
            max-width: 100% !important;
        }

        .select2-container--default .select2-selection--single {
            height: 52px !important;
            border: 2px solid #E5E7EB !important;
            border-radius: 16px !important;
            padding: 0 20px !important;
            display: flex !important;
            align-items: center !important;
            background: linear-gradient(135deg, #ffffff 0%, #fefefe 100%) !important;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05), inset 0 1px 0 rgba(255, 255, 255, 0.1) !important;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
            position: relative !important;
            overflow: hidden !important;
        }

        .select2-container--default .select2-selection--single::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent 30%, rgba(255, 215, 0, 0.1) 50%, transparent 70%);
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
        }

        .select2-container--default .select2-selection--single:hover::before {
            opacity: 1;
        }

        .select2-container--default .select2-selection--single:hover {
            border-color: #FFD700 !important;
            transform: translateY(-1px) !important;
            box-shadow: 0 8px 25px rgba(255, 215, 0, 0.15), inset 0 1px 0 rgba(255, 255, 255, 0.2) !important;
        }

        .select2-container--default.select2-container--focus .select2-selection--single,
        .select2-container--default .select2-selection--single:focus {
            border-color: #FFD700 !important;
            box-shadow: 0 0 0 4px rgba(255, 215, 0, 0.15), 0 4px 12px rgba(255, 215, 0, 0.1) !important;
            outline: none !important;
            transform: translateY(-1px) !important;
        }

        .select2-container--default .select2-selection--single .select2-selection__rendered {
            color: #1F2937 !important;
            line-height: 48px !important;
            padding: 0 !important;
            font-size: 15px !important;
            font-weight: 500 !important;
            display: flex !important;
            align-items: center !important;
        }

        .select2-container--default .select2-selection--single .select2-selection__placeholder {
            color: #6B7280 !important;
            font-style: italic !important;
            display: flex !important;
            align-items: center !important;
        }

        .select2-container--default .select2-selection--single .select2-selection__placeholder::before {
            content: '📱';
            margin-right: 8px;
            font-size: 16px;
        }

        .select2-container--default .select2-selection--single .select2-selection__arrow {
            height: 48px !important;
            right: 20px !important;
            width: 20px !important;
        }

        .select2-container--default .select2-selection--single .select2-selection__arrow b {
            border-color: #FFD700 transparent transparent transparent !important;
            border-width: 6px 6px 0 6px !important;
            margin-top: -3px !important;
            transition: all 0.3s ease !important;
        }

        .select2-container--default.select2-container--open .select2-selection--single .select2-selection__arrow b {
            transform: rotate(180deg) !important;
        }

        /* Custom Dropdown Styling */
        .select2-dropdown {
            border: 2px solid #FFD700 !important;
            border-radius: 16px !important;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.15), 0 0 0 1px rgba(255, 215, 0, 0.1) !important;
            background: white !important;
            margin-top: 4px !important;
            overflow: hidden !important;
        }

        .select2-dropdown::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #FFD700, #FFC300, #FFB347);
        }

        .select2-results {
            max-height: 300px !important;
        }

        .select2-container--default .select2-results__option {
            padding: 14px 20px !important;
            font-size: 14px !important;
            transition: all 0.2s ease !important;
            border-bottom: 1px solid #F3F4F6 !important;
            display: flex !important;
            align-items: center !important;
        }

        .select2-container--default .select2-results__option:last-child {
            border-bottom: none !important;
        }

        .select2-container--default .select2-results__option--highlighted[aria-selected] {
            background: linear-gradient(135deg, #FFD700, #FFC300) !important;
            color: #1F2937 !important;
            font-weight: 500 !important;
            transform: translateX(4px) !important;
        }

        .select2-container--default .select2-results__option[aria-selected=true] {
            background: #FEF3C7 !important;
            color: #92400E !important;
            font-weight: 600 !important;
        }

        /* Search Field Styling */
        .select2-search--dropdown {
            padding: 12px !important;
            background: #FEFCE8 !important;
            border-bottom: 2px solid #FEF3C7 !important;
        }

        .select2-search--dropdown .select2-search__field {
            border: 2px solid #E5E7EB !important;
            border-radius: 12px !important;
            padding: 12px 16px !important;
            width: 100% !important;
            font-size: 14px !important;
            background: white !important;
            transition: all 0.3s ease !important;
        }

        .select2-search--dropdown .select2-search__field:focus {
            border-color: #FFD700 !important;
            outline: none !important;
            box-shadow: 0 0 0 3px rgba(255, 215, 0, 0.15) !important;
        }

        .select2-search--dropdown .select2-search__field::placeholder {
            color: #9CA3AF !important;
            font-style: italic !important;
        }

        /* Brand specific styling */
        .brand-vivo {
            color: #3B82F6 !important;
        }

        .brand-redmi,
        .brand-xiaomi {
            color: #F97316 !important;
        }

        .brand-oppo {
            color: #10B981 !important;
        }

        .brand-realme {
            color: #EAB308 !important;
        }

        .brand-samsung {
            color: #1E40AF !important;
        }

        .brand-infinix {
            color: #8B5CF6 !important;
        }

        .brand-other {
            color: #6B7280 !important;
        }

        /* Loading state */
        .select2-container--default.select2-container--loading .select2-selection--single::after {
            content: '';
            position: absolute;
            right: 50px;
            top: 50%;
            transform: translateY(-50%);
            width: 16px;
            height: 16px;
            border: 2px solid #FFD700;
            border-top: 2px solid transparent;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        /* Mobile optimizations */
        @media (max-width: 768px) {
            .container {
                padding-left: 16px;
                padding-right: 16px;
            }

            .selection-card {
                padding: 24px 20px;
            }

            .selection-card h3 {
                font-size: 18px;
            }

            .glass-card {
                margin: 16px;
                padding: 24px 20px;
            }

            .grid-cols-1 {
                gap: 16px;
            }

            .md\\:grid-cols-2 {
                grid-template-columns: 1fr;
            }

            .text-4xl,
            .text-3xl {
                font-size: 28px;
                line-height: 1.2;
            }

            .text-2xl {
                font-size: 22px;
            }

            .py-10 {
                padding-top: 32px;
                padding-bottom: 32px;
            }

            /* Mobile select styling */
            .hp-select-container {
                max-width: 100% !important;
            }

            .select2-container--default .select2-selection--single {
                height: 48px !important;
                font-size: 14px !important;
            }

            .select2-container--default .select2-selection--single .select2-selection__rendered {
                line-height: 44px !important;
            }

            .select2-dropdown {
                max-width: calc(100vw - 32px) !important;
            }
        }

        @media (max-width: 640px) {
            .hp-select-container {
                max-width: 100% !important;
            }

            .select2-container--default .select2-selection--single {
                height: 44px !important;
                padding: 0 16px !important;
            }

            .select2-container--default .select2-selection--single .select2-selection__rendered {
                line-height: 40px !important;
                font-size: 13px !important;
            }

            .select2-container--default .select2-selection--single .select2-selection__arrow {
                height: 40px !important;
                right: 16px !important;
            }

            .select2-dropdown {
                border-radius: 12px !important;
                max-width: calc(100vw - 16px) !important;
                left: 8px !important;
            }

            .select2-container--default .select2-results__option {
                padding: 10px 16px !important;
                font-size: 13px !important;
            }
        }

        @media (min-width: 641px) and (max-width: 768px) {
            .hp-select-container {
                max-width: 24rem !important;
                /* 384px for tablet */
            }
        }

        @media (min-width: 769px) {
            .hp-select-container {
                max-width: 28rem;
                /* 448px for desktop */
            }
        }

        .notification-show {
            transform: translateY(0) !important;
        }

        .animate-spin {
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
            overflow-x: auto;
            display: block;
            white-space: nowrap;
        }

        @media (max-width: 768px) {
            .data-table {
                font-size: 12px;
            }

            .data-table th,
            .data-table td {
                padding: 6px 4px;
                min-width: 80px;
            }
        }

        .data-table th,
        .data-table td {
            border: 1px solid #ddd;
            padding: 12px 8px;
            text-align: left;
            background: white;
        }

        .data-table th {
            background: linear-gradient(135deg, #FFD700, #FFC300);
            color: #374151;
            font-weight: 600;
            position: sticky;
            top: 0;
        }

        .data-table tr:nth-child(even) {
            background-color: #FFFBEB;
        }

        .data-table tr:hover {
            background-color: #FEF3C7;
        }

        /* Input improvements */
        .form-input {
            transition: all 0.3s ease;
            border: 2px solid #E5E7EB;
            background: white;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .form-input:focus {
            border-color: #FFD700;
            box-shadow: 0 0 0 3px rgba(255, 215, 0, 0.1);
            outline: none;
        }

        .error-input {
            border-color: #EF4444 !important;
            box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1) !important;
        }

        .error-message {
            color: #EF4444;
            font-size: 0.875rem;
            margin-top: 0.25rem;
            font-weight: 500;
        }

        .status-badge {
            display: inline-block;
            padding: 0.375rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .status-verification {
            background: linear-gradient(135deg, #FEF3C7, #FDE68A);
            color: #92400E;
            border: 1px solid #F59E0B;
        }

        .status-ok {
            background: linear-gradient(135deg, #D1FAE5, #A7F3D0);
            color: #065F46;
            border: 1px solid #10B981;
        }

        .status-no-acc {
            background: linear-gradient(135deg, #FEE2E2, #FECACA);
            color: #991B1B;
            border: 1px solid #EF4444;
        }

        .status-cancel {
            background: linear-gradient(135deg, #F3F4F6, #E5E7EB);
            color: #374151;
            border: 1px solid #9CA3AF;
        }

        /* Loading spinner improvements */
        .loading-overlay {
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(4px);
        }

        .loading-content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
        }

        /* Responsive table wrapper */
        .table-responsive {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        /* Button improvements */
        .btn-gradient {
            background: linear-gradient(135deg, #FFD700, #FFC300);
            transition: all 0.3s ease;
        }

        .btn-gradient:hover {
            background: linear-gradient(135deg, #FFC300, #FFB347);
            transform: translateY(-2px);
        }

        .btn-gradient:active {
            transform: translateY(0);
        }

        @media print {
            body * {
                visibility: hidden;
            }

            #outputSection,
            #outputSection * {
                visibility: visible;
            }

            #outputSection {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
            }
        }
    </style>
</head>

<body class="font-poppins">
    <!-- Loading Spinner -->
    <div id="loadingSpinner" class="fixed inset-0 loading-overlay flex items-center justify-center z-50 hidden">
        <div class="loading-content p-8 rounded-2xl shadow-2xl text-center max-w-sm mx-4">
            <div class="animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-yellow-500 mx-auto mb-4"></div>
            <p class="text-lg font-semibold text-gray-800">Memproses...</p>
            <p class="text-sm text-gray-600 mt-2">Harap tunggu sebentar</p>
        </div>
    </div>

    <!-- Notification -->
    <div id="notification"
        class="fixed bottom-4 right-4 px-6 py-4 rounded-xl shadow-lg transform translate-y-16 transition-all duration-300 z-50 hidden max-w-sm">
        <div class="flex items-center">
            <i id="notificationIcon" class="fas fa-check-circle mr-3 text-lg"></i>
            <span id="notificationText" class="font-medium">Pesan notifikasi</span>
        </div>
    </div>

    <!-- Modal untuk Ubah Status -->
    <div id="statusModal"
        class="fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center z-50 hidden p-4">
        <div class="glass-card rounded-2xl shadow-2xl p-8 w-full max-w-md" data-aos="fade-up">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-bold text-gray-800 flex items-center">
                    <i class="fas fa-edit text-yellow-500 mr-2"></i>
                    Ubah Status HP
                </h3>
                <button onclick="closeStatusModal()"
                    class="text-gray-500 hover:text-gray-700 hover:bg-gray-100 p-2 rounded-full transition">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>

            <form id="statusForm" class="space-y-4">
                <input type="hidden" id="statusId" name="id">
                <input type="hidden" id="statusRowNumber" name="rowNumber">

                <div>
                    <label class="block text-gray-700 font-semibold mb-2">NPK:</label>
                    <input type="text" id="statusNpk" readonly
                        class="w-full px-4 py-3 bg-gray-50 border-2 border-gray-200 rounded-xl font-mono">
                </div>

                <div>
                    <label class="block text-gray-700 font-semibold mb-2">Tipe HP:</label>
                    <input type="text" id="statusTipeHp" readonly
                        class="w-full px-4 py-3 bg-gray-50 border-2 border-gray-200 rounded-xl">
                </div>

                <div>
                    <label class="block text-gray-700 font-semibold mb-2">Status Baru:</label>
                    <select name="status" id="newStatus" required
                        class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl form-input">
                        <option value="">-- Pilih Status --</option>
                        <option value="VERIFIKASI">VERIFIKASI</option>
                        <option value="OK">OK</option>
                        <option value="NO ACC">NO ACC</option>
                        <option value="CANCEL">CANCEL</option>
                    </select>
                </div>

                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" onclick="closeStatusModal()"
                        class="px-6 py-3 border-2 border-gray-300 rounded-xl text-gray-700 hover:bg-gray-50 transition font-medium">
                        Batal
                    </button>
                    <button type="submit" class="px-6 py-3 btn-gradient text-white rounded-xl font-medium">
                        <i class="fas fa-save mr-2"></i>
                        Simpan Perubahan
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Main Selection Screen -->
    <div id="mainSelectionScreen"
        class="container mx-auto max-w-6xl py-8 px-4 min-h-screen flex flex-col justify-center">
        <div class="text-center mb-12">
            <div class="mb-6">
                <div class="inline-block p-4 bg-white rounded-full shadow-large mb-4">
                    <i class="fas fa-building text-4xl text-yellow-500"></i>
                </div>
            </div>
            <h1 class="text-4xl md:text-5xl font-bold text-gray-800 mb-6 leading-tight">
                Aplikasi Koperasi<br>
                <span class="text-yellow-600">Sigap Nusantara</span>
            </h1>
            <p class="text-xl text-gray-600 max-w-2xl mx-auto leading-relaxed">
                Sistem manajemen terpadu untuk koperasi modern. Silakan pilih aplikasi yang Anda butuhkan.
            </p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 max-w-4xl mx-auto">
            <div class="selection-card rounded-3xl shadow-large p-8 text-center" onclick="showApplication('hp')"
                data-aos="fade-right" data-aos-delay="100">
                <div class="icon-container w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-6">
                    <i class="fas fa-mobile-alt text-white text-3xl"></i>
                </div>
                <h3 class="text-2xl font-bold text-gray-800 mb-3">Aplikasi HP</h3>
                <p class="text-gray-600 mb-8 leading-relaxed">Kelola data HP karyawan dengan mudah dan efisien</p>
                <button
                    class="btn-animated btn-gradient text-white px-8 py-3 rounded-xl font-semibold flex items-center justify-center mx-auto">
                    Pilih Aplikasi <i class="fas fa-arrow-right ml-2"></i>
                </button>
            </div>

            <div class="selection-card rounded-3xl shadow-large p-8 text-center" onclick="showApplication('seragam')"
                data-aos="fade-left" data-aos-delay="200">
                <div class="icon-container w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-6">
                    <i class="fas fa-tshirt text-white text-3xl"></i>
                </div>
                <h3 class="text-2xl font-bold text-gray-800 mb-3">Aplikasi Seragam</h3>
                <p class="text-gray-600 mb-8 leading-relaxed">Manajemen data seragam karyawan yang terintegrasi</p>
                <button
                    class="btn-animated btn-gradient text-white px-8 py-3 rounded-xl font-semibold flex items-center justify-center mx-auto">
                    Pilih Aplikasi <i class="fas fa-arrow-right ml-2"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- HP Application Screen -->
    <div id="hpApplication" class="container mx-auto max-w-6xl py-8 px-4 min-h-screen hidden">
        <div class="flex items-center justify-between mb-8 flex-wrap gap-4">
            <div class="flex items-center">
                <button onclick="backToMainSelection()"
                    class="mr-4 text-yellow-500 hover:text-yellow-600 p-2 hover:bg-yellow-50 rounded-full transition">
                    <i class="fas fa-arrow-left text-2xl"></i>
                </button>
                <h2 class="text-2xl md:text-3xl font-bold text-gray-800 flex items-center">
                    <i class="fas fa-mobile-alt text-yellow-500 text-2xl mr-3"></i>
                    Aplikasi HP Karyawan
                </h2>
            </div>
            <button onclick="backToMainSelection()"
                class="btn-animated bg-gray-500 text-white px-6 py-3 rounded-xl hover:bg-gray-600 transition font-medium">
                <i class="fas fa-home mr-2"></i> Menu Utama
            </button>
        </div>

        <div class="text-center mb-12">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-800 mb-4">
                <i class="fas fa-mobile-alt text-yellow-500 mr-3"></i>
                Sistem Data HP Karyawan
            </h1>
            <p class="text-lg text-gray-600">Koperasi Sigap Nusantara</p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 max-w-4xl mx-auto">
            <div class="selection-card rounded-3xl shadow-large p-8 text-center" onclick="showHpSection('search')"
                data-aos="fade-right">
                <div class="icon-container w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-6">
                    <i class="fas fa-search text-white text-3xl"></i>
                </div>
                <h3 class="text-xl font-bold text-gray-800 mb-3">Pencarian Data HP</h3>
                <p class="text-gray-600 mb-6">Cari dan kelola data HP karyawan berdasarkan NPK</p>
                <button class="btn-animated btn-gradient text-white px-6 py-3 rounded-xl font-medium">
                    Pilih <i class="fas fa-arrow-right ml-2"></i>
                </button>
            </div>

            <div class="selection-card rounded-3xl shadow-large p-8 text-center" onclick="showHpSection('input')"
                data-aos="fade-left">
                <div class="icon-container w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-6">
                    <i class="fas fa-edit text-white text-3xl"></i>
                </div>
                <h3 class="text-xl font-bold text-gray-800 mb-3">Input Data HP Baru</h3>
                <p class="text-gray-600 mb-6">Tambahkan data HP karyawan baru ke sistem</p>
                <button class="btn-animated btn-gradient text-white px-6 py-3 rounded-xl font-medium">
                    Pilih <i class="fas fa-arrow-right ml-2"></i>
                </button>
            </div>
        </div>

        <div class="mt-12 text-center">
            <button onclick="backToMainSelection()"
                class="btn-animated bg-gray-500 text-white px-8 py-4 rounded-xl hover:bg-gray-600 transition font-medium">
                <i class="fas fa-arrow-left mr-2"></i> Kembali ke Menu Sebelumnya
            </button>
        </div>
    </div>

    <!-- HP Search Section -->
    <div id="hpSearchSection" class="container mx-auto max-w-6xl py-8 px-4 hidden">
        <div class="flex items-center justify-between mb-8 flex-wrap gap-4">
            <div class="flex items-center">
                <button onclick="backToHpApplication()"
                    class="mr-4 text-yellow-500 hover:text-yellow-600 p-2 hover:bg-yellow-50 rounded-full transition">
                    <i class="fas fa-arrow-left text-2xl"></i>
                </button>
                <h2 class="text-2xl md:text-3xl font-bold text-gray-800 flex items-center">
                    <i class="fas fa-search text-yellow-500 text-2xl mr-3"></i>
                    Pencarian Data HP
                </h2>
            </div>
            <button onclick="backToMainSelection()"
                class="btn-animated bg-gray-500 text-white px-6 py-3 rounded-xl hover:bg-gray-600 transition font-medium">
                <i class="fas fa-home mr-2"></i> Menu Utama
            </button>
        </div>

        <div class="glass-card rounded-3xl shadow-2xl p-8 mb-10" data-aos="fade-up">
            <div class="mb-6">
                <label class="block text-gray-700 font-semibold mb-3 text-lg">
                    <i class="fas fa-search text-yellow-500 mr-2"></i>
                    Cari berdasarkan NPK:
                </label>
                <div class="flex gap-3">
                    <input type="text" id="searchNpk"
                        class="flex-1 px-4 py-4 border-2 border-gray-200 rounded-xl form-input text-lg"
                        placeholder="Masukkan NPK karyawan...">
                    <button id="searchBtn"
                        class="btn-animated btn-gradient text-white px-8 py-4 rounded-xl font-medium flex items-center">
                        <i class="fas fa-search mr-2"></i> Cari
                    </button>
                </div>
                <div id="searchNpkError" class="error-message hidden">NPK harus diisi</div>
            </div>

            <div id="searchResults" class="mt-8 hidden">
                <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                    <i class="fas fa-list text-yellow-500 mr-2"></i>
                    Hasil Pencarian
                </h3>
                <div class="table-responsive">
                    <table class="data-table w-full">
                        <thead>
                            <tr>
                                <th><i class="fas fa-calendar mr-1"></i>Tanggal</th>
                                <th><i class="fas fa-id-card mr-1"></i>NPK</th>
                                <th><i class="fas fa-phone mr-1"></i>No. Telp</th>
                                <th><i class="fas fa-credit-card mr-1"></i>Cicilan</th>
                                <th><i class="fas fa-mobile-alt mr-1"></i>Tipe HP</th>
                                <th><i class="fas fa-map-marker-alt mr-1"></i>Alamat</th>
                                <th><i class="fas fa-note-sticky mr-1"></i>Keterangan</th>
                                <th><i class="fas fa-flag mr-1"></i>Status</th>
                                <th><i class="fas fa-cog mr-1"></i>Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="resultsBody"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <div class="text-center">
            <button onclick="backToHpApplication()"
                class="btn-animated bg-gray-500 text-white px-8 py-4 rounded-xl hover:bg-gray-600 transition font-medium">
                <i class="fas fa-arrow-left mr-2"></i> Kembali ke Menu Sebelumnya
            </button>
        </div>
    </div>

    <!-- HP Input Section -->
    <div id="hpInputSection" class="container mx-auto max-w-4xl py-8 px-4 hidden">
        <div class="flex items-center justify-between mb-8 flex-wrap gap-4">
            <div class="flex items-center">
                <button onclick="backToHpApplication()"
                    class="mr-4 text-yellow-500 hover:text-yellow-600 p-2 hover:bg-yellow-50 rounded-full transition">
                    <i class="fas fa-arrow-left text-2xl"></i>
                </button>
                <h2 class="text-2xl md:text-3xl font-bold text-gray-800 flex items-center">
                    <i class="fas fa-mobile-alt text-yellow-500 text-2xl mr-3"></i>
                    Form Input HP Karyawan
                </h2>
            </div>
            <button onclick="backToMainSelection()"
                class="btn-animated bg-gray-500 text-white px-6 py-3 rounded-xl hover:bg-gray-600 transition font-medium">
                <i class="fas fa-home mr-2"></i> Menu Utama
            </button>
        </div>

        <div class="glass-card rounded-3xl shadow-2xl p-8" data-aos="fade-up">
            <form id="formHP" class="space-y-8">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-gray-700 font-semibold mb-3 text-lg">
                            <i class="fas fa-calendar text-yellow-500 mr-2"></i>
                            Tanggal <span class="text-red-500">*</span>
                        </label>
                        <input type="date" name="tanggal" id="tanggal" required
                            class="w-full px-4 py-4 border-2 rounded-xl form-input">
                        <div id="tanggalError" class="error-message hidden">Tanggal harus diisi</div>
                    </div>
                    <div>
                        <label class="block text-gray-700 font-semibold mb-3 text-lg">
                            <i class="fas fa-id-card text-yellow-500 mr-2"></i>
                            NPK <span class="text-red-500">*</span>
                        </label>
                        <input type="text" name="npk" id="npk" required
                            class="w-full px-4 py-4 border-2 rounded-xl form-input font-mono"
                            placeholder="Contoh: 123456">
                        <div id="npkError" class="error-message hidden">NPK harus diisi</div>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-gray-700 font-semibold mb-3 text-lg">
                            <i class="fas fa-phone text-yellow-500 mr-2"></i>
                            No. Telp <span class="text-red-500">*</span>
                        </label>
                        <input type="text" name="notelp" id="notelp" required
                            class="w-full px-4 py-4 border-2 rounded-xl form-input" placeholder="Contoh: 081234567890">
                        <div id="notelpError" class="error-message hidden">No. Telp harus diisi dan berupa angka</div>
                    </div>
                    <div>
                        <label class="block text-gray-700 font-semibold mb-3 text-lg">
                            <i class="fas fa-credit-card text-yellow-500 mr-2"></i>
                            Cicilan <span class="text-red-500">*</span>
                        </label>
                        <input type="text" name="cicilan" id="cicilan" required
                            class="w-full px-4 py-4 border-2 rounded-xl form-input" placeholder="Contoh: 12x">
                        <div id="cicilanError" class="error-message hidden">Cicilan harus diisi</div>
                    </div>
                </div>

                <div>
                    <label class="block text-gray-700 font-semibold mb-3 text-lg">
                        <i class="fas fa-mobile-alt text-yellow-500 mr-2"></i>
                        Tipe HP <span class="text-red-500">*</span>
                    </label>
                    <div class="hp-select-container w-full sm:max-w-md">
                        <select id="tipehp" name="tipehp" class="w-full" required>
                            <option value="">Pilih atau cari tipe HP...</option>
                            <!-- VIVO -->
                            <option value="VIVO Y29 6/128">VIVO Y29 6/128</option>
                            <option value="VIVO Y29 8/128">VIVO Y29 8/128</option>
                            <option value="VIVO Y29 8/256">VIVO Y29 8/256</option>
                            <option value="VIVO Y19S 6/128">VIVO Y19S 6/128</option>
                            <option value="VIVO Y19S PRO 4/64">VIVO Y19S PRO 4/64</option>
                            <option value="VIVO Y19S PRO 4/128">VIVO Y19S PRO 4/128</option>
                            <option value="VIVO Y19S PRO 6/128">VIVO Y19S PRO 6/128</option>
                            <option value="VIVO V40 LITE 8/128">VIVO V40 LITE 8/128</option>
                            <option value="VIVO V40 LITE 8/256">VIVO V40 LITE 8/256</option>
                            <option value="VIVO V40 12/256 5G">VIVO V40 12/256 5G</option>
                            
                            <!-- XIAOMI/REDMI -->
                            <option value="REDMI A3 4/128">REDMI A3 4/128</option>
                            <option value="REDMI A5 4/128">REDMI A5 4/128</option>
                            <option value="REDMI 13 8/128">REDMI 13 8/128</option>
                            <option value="REDMI 13 8/256">REDMI 13 8/256</option>
                            <option value="REDMI 13X 8/128">REDMI 13X 8/128</option>
                            <option value="REDMI 13X 8/256">REDMI 13X 8/256</option>
                            <option value="REDMI 14C 6/128">REDMI 14C 6/128</option>
                            <option value="REDMI 14C 8/256">REDMI 14C 8/256</option>
                            <option value="REDMI 14T 12/512 5G">REDMI 14T 12/512 5G</option>
                            <option value="REDMI NOTE 14 8/128">REDMI NOTE 14 8/128</option>
                            <option value="REDMI NOTE 14 8/256">REDMI NOTE 14 8/256</option>
                            <option value="REDMI NOTE 14 8/256 5G">REDMI NOTE 14 8/256 5G</option>
                            <option value="REDMI NOTE 14 12/512 5G">REDMI NOTE 14 12/512 5G</option>
                            <option value="REDMI NOTE 14 PRO 8/256 5G">REDMI NOTE 14 PRO 8/256 5G</option>
                            <option value="REDMI NOTE 14 PRO 12/512 5G">REDMI NOTE 14 PRO 12/512 5G</option>
                            <option value="REDMI POCO PAD 8/256">REDMI POCO PAD 8/256</option>
                            
                            <!-- OPPO -->
                            <option value="OPPO A3X 6/128">OPPO A3X 6/128</option>
                            <option value="OPPO A3 PRO 8/256 5G">OPPO A3 PRO 8/256 5G</option>
                            <option value="OPPO A60 8/128">OPPO A60 8/128</option>
                            <option value="OPPO A60 8/256">OPPO A60 8/256</option>
                            
                            <!-- REALME -->
                            <option value="REALME C63 8/128">REALME C63 8/128</option>
                            <option value="REALME C75 8/128">REALME C75 8/128</option>
                            <option value="REALME C75 8/256">REALME C75 8/256</option>
                            <option value="REALME 13 NFC 8/128">REALME 13 NFC 8/128</option>
                            <option value="REALME 13 NFC 8/256">REALME 13 NFC 8/256</option>
                            <option value="REALME NOTE 60 6/128">REALME NOTE 60 6/128</option>
                            
                            <!-- SAMSUNG -->
                            <option value="SAMSUNG A06 4/64">SAMSUNG A06 4/64</option>
                            <option value="SAMSUNG A06 4/128">SAMSUNG A06 4/128</option>
                            <option value="SAMSUNG A06 6/128">SAMSUNG A06 6/128</option>
                            <option value="SAMSUNG A16 8/128">SAMSUNG A16 8/128</option>
                            <option value="SAMSUNG A16 8/256">SAMSUNG A16 8/256</option>
                            <option value="SAMSUNG A16 8/256 5G">SAMSUNG A16 8/256 5G</option>
                            <option value="SAMSUNG A25 8/256 5G">SAMSUNG A25 8/256 5G</option>
                            
                            <!-- INFINIX -->
                            <option value="INFINIX SMART 9 4/128">INFINIX SMART 9 4/128</option>
                            <option value="INFINIX SMART 10 4/128">INFINIX SMART 10 4/128</option>
                            <option value="INFINIX SMART 10 PLUS 8/128">INFINIX SMART 10 PLUS 8/128</option>
                            <option value="INFINIX HOT 50 6/128">INFINIX HOT 50 6/128</option>
                            <option value="INFINIX HOT 50i 6/128">INFINIX HOT 50i 6/128</option>
                            <option value="INFINIX HOT 50 PRO 8/256">INFINIX HOT 50 PRO 8/256</option>
                            <option value="INFINIX HOT 50 PRO+ 8/256">INFINIX HOT 50 PRO+ 8/256</option>
                            <option value="INFINIX HOT 60i 8/256">INFINIX HOT 60i 8/256</option>
                            <option value="INFINIX HOT 60 PRO 8/256">INFINIX HOT 60 PRO 8/256</option>
                            
                            <!-- TECNO -->
                            <option value="TECNO SPARK GO 1 4/128">TECNO SPARK GO 1 4/128</option>
                            <option value="TECNO SPARK 30C 8/256">TECNO SPARK 30C 8/256</option>
                            <option value="TECNO SPARK 30 PRO 8/128">TECNO SPARK 30 PRO 8/128</option>
                            <option value="TECNO POVA 6 8/256">TECNO POVA 6 8/256</option>
                            <option value="TECNO POVA 6 12/256">TECNO POVA 6 12/256</option>
                            <option value="TECNO POVA 7 8/128">TECNO POVA 7 8/128</option>
                            <option value="TECNO POVA 7 8/256">TECNO POVA 7 8/256</option>
                            <option value="TECNO CAMON 40 8/256">TECNO CAMON 40 8/256</option>
                            
                            <!-- ITEL -->
                            <option value="ITEL S25 8/128">ITEL S25 8/128</option>
                            <option value="ITEL S25 ULTRA 8/256">ITEL S25 ULTRA 8/256</option>
                            <option value="ITEL TAB VISTA 30 + KEYBOARD 4/128">ITEL TAB VISTA 30 + KEYBOARD 4/128</option>
                            
                            <!-- ADVAN -->
                            <option value="ADVAN TAB VX LITE 6/128">ADVAN TAB VX LITE 6/128</option>
                            
                            <!-- APPLE -->
                            <option value="IPHONE 15 128">iPhone 15 128GB</option>
                            <option value="IPHONE 15 256 PONSELINDO">iPhone 15 256GB (Ponselindo)</option>
                            <option value="IPHONE 15 512">iPhone 15 512GB</option>
                            <option value="IPHONE 15 512 PONSELINDO">iPhone 15 512GB (Ponselindo)</option>
                            
                            <!-- ELEKTRONIK LAIN -->
                            <option value="LAPTOP LENOVO">Laptop Lenovo</option>
                            <option value="TV XIAOMI 32">TV Xiaomi 32"</option>
                            <option value="TV XIAOMI 43">TV Xiaomi 43"</option>
                            <option value="GOOGLE TV XIAOMI 43">Google TV Xiaomi 43"</option>
                            <option value="POLYTRON KULKAS 1 DOOR PRA15CRX">Polytron Kulkas 1 Door PRA15CRX</option>
                            <option value="MAGICOM YONGMA SMC 4023">Magicom Yongma SMC 4023</option>
                            <option value="MAGICOM MIYAKO">Magicom Miyako</option>
                            <option value="BARETONE SPEAKER 15 BWR">Bareton Speaker 15 BWR</option>
                            <option value="OTHER">🔧 Lainnya (Tulis Manual)</option>
                        </select>
                    </div>
                    <p class="text-xs text-gray-500 mt-2 flex items-center">
                        <i class="fas fa-info-circle mr-1"></i>
                        Klik untuk membuka dropdown atau ketik untuk mencari langsung
                    </p>
                    <div id="tipehpError" class="error-message hidden">Tipe HP harus dipilih</div>
                    <div id="otherHpContainer" class="hidden mt-4">
                        <div class="relative max-w-md">
                            <input type="text" id="otherHpInput" name="other_hp"
                                placeholder="Masukkan tipe HP lainnya..."
                                class="w-full px-4 py-4 border-2 rounded-xl form-input pl-12">
                            <i
                                class="fas fa-edit absolute left-4 top-1/2 transform -translate-y-1/2 text-yellow-500"></i>
                        </div>
                        <div id="otherHpError" class="error-message hidden">Tipe HP lainnya harus diisi</div>
                    </div>
                </div>

                <div>
                    <label class="block text-gray-700 font-semibold mb-3 text-lg">
                        <i class="fas fa-map-marker-alt text-yellow-500 mr-2"></i>
                        Alamat Kirim <span class="text-red-500">*</span>
                    </label>
                    <textarea name="alamat" id="alamat" rows="4" required
                        class="w-full px-4 py-4 border-2 rounded-xl form-input resize-none"
                        placeholder="Masukkan alamat lengkap untuk pengiriman..."></textarea>
                    <div id="alamatError" class="error-message hidden">Alamat kirim harus diisi</div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-gray-700 font-semibold mb-3 text-lg">
                            <i class="fas fa-note-sticky text-yellow-500 mr-2"></i>
                            Keterangan
                        </label>
                        <textarea name="keterangan" id="keterangan" rows="3"
                            class="w-full px-4 py-4 border-2 rounded-xl form-input resize-none"
                            placeholder="Keterangan tambahan (opsional)..."></textarea>
                    </div>
                    <div>
                        <label class="block text-gray-700 font-semibold mb-3 text-lg">
                            <i class="fas fa-flag text-yellow-500 mr-2"></i>
                            Status <span class="text-red-500">*</span>
                        </label>
                        <select name="status" id="status" required
                            class="w-full px-4 py-4 border-2 rounded-xl form-input">
                            <option value="">-- Pilih Status --</option>
                            <option value="VERIFIKASI">VERIFIKASI</option>
                            <option value="OK">OK</option>
                            <option value="NO ACC">NO ACC</option>
                            <option value="CANCEL">CANCEL</option>
                        </select>
                        <div id="statusError" class="error-message hidden">Status harus dipilih</div>
                    </div>
                </div>

                <button type="submit"
                    class="w-full btn-animated btn-gradient text-white font-bold py-4 px-6 rounded-xl text-lg">
                    <i class="fas fa-paper-plane mr-3"></i> Kirim Data HP
                </button>
            </form>
        </div>

        <div class="mt-8 text-center">
            <button onclick="backToHpApplication()"
                class="btn-animated bg-gray-500 text-white px-8 py-4 rounded-xl hover:bg-gray-600 transition font-medium">
                <i class="fas fa-arrow-left mr-2"></i> Kembali ke Menu Sebelumnya
            </button>
        </div>
    </div>

    <!-- Seragam Application Screen -->
    <div id="seragamApplication" class="container mx-auto max-w-6xl py-16 px-4 hidden">
        <div class="flex items-center justify-between mb-6">
            <div class="flex items-center">
                <button onclick="backToMainSelection()" class="mr-4 text-yellow-500 hover:text-yellow-600">
                    <i class="fas fa-arrow-left text-2xl"></i>
                </button>
                <h2 class="text-2xl font-bold text-gray-800">
                    <i class="fas fa-tshirt text-yellow-500 text-2xl mr-3"></i> Aplikasi Seragam
                </h2>
            </div>
            <button onclick="backToMainSelection()"
                class="bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition">
                <i class="fas fa-home mr-2"></i> Menu Utama
            </button>
        </div>

        <div class="text-center mb-16" data-aos="fade-up" id="menuSection">
            <h2 class="text-3xl font-bold text-gray-800 mb-8">Silakan pilih menu di bawah:</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <button onclick="navigateTo('box-search')"
                    class="btn-animated bg-gradient-to-r from-yellow-400 to-yellow-500 hover:from-yellow-500 hover:to-yellow-600 text-white font-bold py-5 px-6 rounded-xl shadow-lg flex flex-col items-center justify-center transition-all duration-300 transform hover:scale-105">
                    <i class="fas fa-search text-3xl mb-3"></i>
                    <span class="text-lg">Cari Data PO</span>
                </button>
                <button onclick="navigateTo('box-seragam')"
                    class="btn-animated bg-gradient-to-r from-yellow-500 to-yellow-600 hover:from-yellow-600 hover:to-yellow-700 text-white font-bold py-5 px-6 rounded-xl shadow-lg flex flex-col items-center justify-center transition-all duration-300 transform hover:scale-105">
                    <i class="fas fa-file-invoice text-3xl mb-3"></i>
                    <span class="text-lg">Input Data Seragam</span>
                </button>
                <button onclick="navigateTo('box-po')"
                    class="btn-animated bg-gradient-to-r from-yellow-600 to-yellow-700 hover:from-yellow-700 hover:to-yellow-800 text-white font-bold py-5 px-6 rounded-xl shadow-lg flex flex-col items-center justify-center transition-all duration-300 transform hover:scale-105">
                    <i class="fas fa-receipt text-3xl mb-3"></i>
                    <span class="text-lg">Input PO_Seragam</span>
                </button>
                <button onclick="navigateTo('box-surat')"
                    class="btn-animated bg-gradient-to-r from-yellow-700 to-yellow-800 hover:from-yellow-800 hover:to-yellow-900 text-white font-bold py-5 px-6 rounded-xl shadow-lg flex flex-col items-center justify-center transition-all duration-300 transform hover:scale-105">
                    <i class="fas fa-truck text-3xl mb-3"></i>
                    <span class="text-lg">Buat Surat Jalan</span>
                </button>
            </div>
        </div>

        <div class="mt-12 text-center">
            <button onclick="backToMainSelection()"
                class="bg-gray-500 text-white px-6 py-3 rounded-lg hover:bg-gray-600 transition">
                <i class="fas fa-arrow-left mr-2"></i> Kembali ke Menu Sebelumnya
            </button>
        </div>
    </div>

    <!-- Seragam Form Container -->
    <div class="container mx-auto max-w-4xl py-16 px-4" id="formContainer" style="display: none;">
        <!-- Form Cari Data PO -->
        <div class="bg-white rounded-2xl shadow-2xl p-8 mb-10" id="box-search" style="display: none;"
            data-aos="fade-up">
            <div class="flex items-center justify-between mb-6">
                <div class="flex items-center">
                    <i class="fas fa-search text-yellow-500 text-2xl mr-3"></i>
                    <h2 class="text-2xl font-bold text-gray-800">Cari Data PO</h2>
                </div>
                <button onclick="backToMainSelection()"
                    class="bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition">
                    <i class="fas fa-home mr-2"></i> Menu Utama
                </button>
            </div>
            <div id="notif-search" class="text-center font-bold mb-6 p-3 rounded-lg"></div>
            <form id="form-search" class="space-y-6">
                <div>
                    <label class="block text-gray-700 font-semibold mb-2">Nomor PO:</label>
                    <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <i class="fas fa-hashtag text-gray-400"></i>
                        </div>
                        <input type="text" name="search_po" required
                            class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-yellow-500 focus:border-transparent shadow-sm">
                    </div>
                </div>
                <button type="submit"
                    class="w-full bg-gradient-to-r from-yellow-400 to-yellow-500 hover:from-yellow-500 hover:to-yellow-600 text-white font-bold py-3 px-4 rounded-xl shadow-lg transition-all duration-300 transform hover:scale-105">
                    <i class="fas fa-search mr-2"></i> Cari PO
                </button>
            </form>
            <div id="search-results" class="mt-8 space-y-4"></div>

            <div class="mt-8 text-center">
                <button onclick="backToSeragamApplication()"
                    class="bg-gray-500 text-white px-6 py-3 rounded-lg hover:bg-gray-600 transition">
                    <i class="fas fa-arrow-left mr-2"></i> Kembali ke Menu Sebelumnya
                </button>
            </div>
        </div>

        <!-- Form Data Seragam -->
        <div class="bg-white rounded-2xl shadow-2xl p-8 mb-10" id="box-seragam" style="display: none;"
            data-aos="fade-up">
            <div class="flex items-center justify-between mb-6">
                <div class="flex items-center">
                    <i class="fas fa-file-invoice text-yellow-500 text-2xl mr-3"></i>
                    <h2 class="text-2xl font-bold text-gray-800">Form Data Seragam</h2>
                </div>
                <button onclick="backToMainSelection()"
                    class="bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition">
                    <i class="fas fa-home mr-2"></i> Menu Utama
                </button>
            </div>
            <div id="notif-seragam" class="text-center font-bold mb-6 p-3 rounded-lg"></div>
            <form id="form-seragam" class="space-y-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">Tanggal:</label>
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <i class="fas fa-calendar-alt text-gray-400"></i>
                            </div>
                            <input type="date" name="tanggal" required
                                class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-yellow-500 focus:border-transparent shadow-sm">
                        </div>
                    </div>
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">No. Invoice:</label>
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <i class="fas fa-file-invoice text-gray-400"></i>
                            </div>
                            <input type="text" name="no_inv" required
                                class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-yellow-500 focus:border-transparent shadow-sm">
                        </div>
                    </div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">No. PO:</label>
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <i class="fas fa-receipt text-gray-400"></i>
                            </div>
                            <input type="text" name="no_po" required
                                class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-yellow-500 focus:border-transparent shadow-sm">
                        </div>
                    </div>
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">Nominal:</label>
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <i class="fas fa-money-bill-wave text-gray-400"></i>
                            </div>
                            <input type="number" name="nominal" required
                                class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-yellow-500 focus:border-transparent shadow-sm">
                        </div>
                    </div>
                </div>
                <div>
                    <label class="block text-gray-700 font-semibold mb-2">User:</label>
                    <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <i class="fas fa-user text-gray-400"></i>
                        </div>
                        <input type="text" name="user" required
                            class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-yellow-500 focus:border-transparent shadow-sm">
                    </div>
                </div>
                <button type="submit"
                    class="w-full bg-gradient-to-r from-yellow-500 to-yellow-600 hover:from-yellow-600 hover:to-yellow-700 text-white font-bold py-3 px-4 rounded-xl shadow-lg transition-all duration-300 transform hover:scale-105">
                    <i class="fas fa-paper-plane mr-2"></i> Kirim Data Seragam
                </button>
            </form>

            <div class="mt-8 text-center">
                <button onclick="backToSeragamApplication()"
                    class="bg-gray-500 text-white px-6 py-3 rounded-lg hover:bg-gray-600 transition">
                    <i class="fas fa-arrow-left mr-2"></i> Kembali ke Menu Sebelumnya
                </button>
            </div>
        </div>

        <!-- Form Data PO_Seragam -->
        <div class="bg-white rounded-2xl shadow-2xl p-8 mb-10" id="box-po" style="display: none;" data-aos="fade-up">
            <div class="flex items-center justify-between mb-6">
                <div class="flex items-center">
                    <i class="fas fa-receipt text-yellow-600 text-2xl mr-3"></i>
                    <h2 class="text-2xl font-bold text-gray-800">Form Data PO_Seragam</h2>
                </div>
                <button onclick="backToMainSelection()"
                    class="bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition">
                    <i class="fas fa-home mr-2"></i> Menu Utama
                </button>
            </div>
            <div id="notif-po" class="text-center font-bold mb-6 p-3 rounded-lg"></div>
            <form id="form-po" class="space-y-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">Tanggal:</label>
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <i class="fas fa-calendar-alt text-gray-400"></i>
                            </div>
                            <input type="date" name="tanggal" required
                                class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-yellow-600 focus:border-transparent shadow-sm">
                        </div>
                    </div>
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">No. BK:</label>
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <i class="fas fa-file-alt text-gray-400"></i>
                            </div>
                            <input type="text" name="no_bk" required
                                class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-yellow-600 focus:border-transparent shadow-sm">
                        </div>
                    </div>
                </div>
                <div>
                    <label class="block text-gray-700 font-semibold mb-2">No. PO:</label>
                    <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <i class="fas fa-receipt text-gray-400"></i>
                        </div>
                        <input type="text" name="no_po" required
                            class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-yellow-600 focus:border-transparent shadow-sm">
                    </div>
                </div>
                <button type="submit"
                    class="w-full bg-gradient-to-r from-yellow-600 to-yellow-700 hover:from-yellow-700 hover:to-yellow-800 text-white font-bold py-3 px-4 rounded-xl shadow-lg transition-all duration-300 transform hover:scale-105">
                    <i class="fas fa-paper-plane mr-2"></i> Kirim Data PO_Seragam
                </button>
            </form>

            <div class="mt-8 text-center">
                <button onclick="backToSeragamApplication()"
                    class="bg-gray-500 text-white px-6 py-3 rounded-lg hover:bg-gray-600 transition">
                    <i class="fas fa-arrow-left mr-2"></i> Kembali ke Menu Sebelumnya
                </button>
            </div>
        </div>

        <!-- Form Surat Jalan -->
        <div class="bg-white rounded-2xl shadow-2xl p-8 mb-10" id="box-surat" style="display: none;" data-aos="fade-up">
            <div class="flex items-center justify-between mb-6">
                <div class="flex items-center">
                    <i class="fas fa-truck text-yellow-700 text-2xl mr-3"></i>
                    <h2 class="text-2xl font-bold text-gray-800">Form Input Surat Jalan</h2>
                </div>
                <button onclick="backToMainSelection()"
                    class="bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition">
                    <i class="fas fa-home mr-2"></i> Menu Utama
                </button>
            </div>
            <form id="suratForm" class="space-y-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">Nomor Surat</label>
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <i class="fas fa-hashtag text-gray-400"></i>
                            </div>
                            <input type="text" name="nomor" required
                                class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-yellow-700 focus:border-transparent shadow-sm">
                        </div>
                    </div>
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">Tanggal</label>
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <i class="fas fa-calendar-alt text-gray-400"></i>
                            </div>
                            <input type="date" name="tanggal" required
                                class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-yellow-700 focus:border-transparent shadow-sm">
                        </div>
                    </div>
                </div>
                <div>
                    <label class="block text-gray-700 font-semibold mb-2">User</label>
                    <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <i class="fas fa-user text-gray-400"></i>
                        </div>
                        <input type="text" name="user" required
                            class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-yellow-700 focus:border-transparent shadow-sm">
                    </div>
                </div>
                <div>
                    <label class="block text-gray-700 font-semibold mb-2">Jumlah Barang</label>
                    <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <i class="fas fa-boxes text-gray-400"></i>
                        </div>
                        <input type="number" name="jumlahBarang" min="1" required
                            class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-yellow-700 focus:border-transparent shadow-sm">
                    </div>
                </div>
                <button type="button" onclick="buatInputBarang()"
                    class="w-full bg-gradient-to-r from-yellow-400 to-yellow-500 hover:from-yellow-500 hover:to-yellow-600 text-white font-bold py-3 px-4 rounded-xl shadow-lg transition-all duration-300">
                    <i class="fas fa-plus-circle mr-2"></i> Buat Form Barang
                </button>
                <div id="barangInputs" class="space-y-6"></div>
                <button type="submit"
                    class="w-full bg-gradient-to-r from-yellow-700 to-yellow-800 hover:from-yellow-800 hover:to-yellow-900 text-white font-bold py-3 px-4 rounded-xl shadow-lg transition-all duration-300">
                    <i class="fas fa-file-contract mr-2"></i> Tampilkan Surat Jalan
                </button>
            </form>
            <div class="text-center mt-8">
                <button id="printButton" onclick="printSurat()"
                    class="hidden bg-gradient-to-r from-yellow-600 to-yellow-700 hover:from-yellow-700 hover:to-yellow-800 text-white font-bold py-3 px-6 rounded-xl shadow-lg transition-all duration-300">
                    <i class="fas fa-print mr-2"></i> Cetak / Simpan PDF
                </button>
            </div>
            <div id="outputSection" class="mt-10 p-6 bg-yellow-50 rounded-xl border border-yellow-200">
                <div id="output"></div>
            </div>

            <div class="mt-8 text-center">
                <button onclick="backToSeragamApplication()"
                    class="bg-gray-500 text-white px-6 py-3 rounded-lg hover:bg-gray-600 transition">
                    <i class="fas fa-arrow-left mr-2"></i> Kembali ke Menu Sebelumnya
                </button>
            </div>
        </div>
    </div>

    <script>
        // Initialize AOS
        document.addEventListener('DOMContentLoaded', function () {
            AOS.init({
                duration: 800,
                easing: 'ease-out-cubic',
                once: true,
                offset: 50
            });

            // Initialize Select2 on document ready
            initializeSelect2();
        });

        // Enhanced Select2 initialization
        function initializeSelect2() {
            if ($.fn.select2) {
                $('#tipehp').select2({
                    placeholder: "🔍 Ketik untuk mencari tipe HP...",
                    allowClear: true,
                    width: '100%',
                    dropdownAutoWidth: false,
                    dropdownParent: $('.hp-select-container'),
                    language: {
                        noResults: function () {
                            return "Tidak ada hasil yang ditemukan";
                        },
                        searching: function () {
                            return "Mencari...";
                        },
                        inputTooShort: function () {
                            return "Ketik minimal 1 karakter";
                        }
                    },
                    templateResult: function (option) {
                        if (!option.id) return option.text;

                        if (option.id === 'OTHER') {
                            return $('<div class="flex items-center"><i class="fas fa-tools mr-3 text-gray-500"></i><span class="font-medium">' + option.text + '</span></div>');
                        }

                        // Determine brand and add appropriate styling and icon
                        let brandClass = 'text-gray-600';
                        let icon = 'fas fa-mobile-alt';
                        const text = option.text.toUpperCase();

                        if (text.includes('VIVO')) {
                            brandClass = 'brand-vivo';
                            icon = 'fab fa-android';
                        } else if (text.includes('REDMI') || text.includes('XIAOMI')) {
                            brandClass = 'brand-redmi';
                            icon = 'fab fa-android';
                        } else if (text.includes('OPPO')) {
                            brandClass = 'brand-oppo';
                            icon = 'fab fa-android';
                        } else if (text.includes('REALME')) {
                            brandClass = 'brand-realme';
                            icon = 'fab fa-android';
                        } else if (text.includes('SAMSUNG')) {
                            brandClass = 'brand-samsung';
                            icon = 'fab fa-android';
                        } else if (text.includes('INFINIX') || text.includes('ITEL') || text.includes('TECNO')) {
                            brandClass = 'brand-infinix';
                            icon = 'fab fa-android';
                        } else if (text.includes('IPHONE') || text.includes('IP 15')) {
                            brandClass = 'text-black';
                            icon = 'fab fa-apple';
                        } else if (text.includes('LAPTOP')) {
                            brandClass = 'text-gray-700';
                            icon = 'fas fa-laptop';
                        } else if (text.includes('TV')) {
                            brandClass = 'text-blue-600';
                            icon = 'fas fa-tv';
                        } else if (text.includes('KULKAS')) {
                            brandClass = 'text-cyan-600';
                            icon = 'fas fa-snowflake';
                        } else if (text.includes('SPEAKER')) {
                            brandClass = 'text-purple-600';
                            icon = 'fas fa-volume-up';
                        }

                        return $(`
                            <div class="flex items-center py-1">
                                <i class="${icon} mr-3 ${brandClass}"></i>
                                <span class="${brandClass} font-medium">${option.text}</span>
                            </div>
                        `);
                    },
                    templateSelection: function (option) {
                        if (!option.id) return option.text;

                        // Add icon to selected option
                        const text = option.text.toUpperCase();
                        let icon = '📱';

                        if (text.includes('IPHONE') || text.includes('IP 15')) {
                            icon = '📱';
                        } else if (text.includes('LAPTOP')) {
                            icon = '💻';
                        } else if (text.includes('TV')) {
                            icon = '📺';
                        } else if (text.includes('KULKAS')) {
                            icon = '❄️';
                        } else if (text.includes('SPEAKER')) {
                            icon = '🔊';
                        } else if (option.id === 'OTHER') {
                            icon = '🔧';
                        }

                        return $(`<span>${icon} ${option.text}</span>`);
                    },
                    escapeMarkup: function (markup) {
                        return markup;
                    }
                }).on('change', function () {
                    const selectedValue = $(this).val();
                    const otherContainer = $('#otherHpContainer');
                    const otherInput = $('#otherHpInput');

                    if (selectedValue === 'OTHER') {
                        otherContainer.removeClass('hidden').addClass('block');
                        otherInput.prop('required', true);
                        // Add smooth animation
                        setTimeout(() => {
                            otherInput.focus();
                        }, 200);
                    } else {
                        otherContainer.removeClass('block').addClass('hidden');
                        otherInput.prop('required', false).val('');
                    }

                    // Clear any error states
                    $(this).removeClass('error-input');
                    $('#tipehpError').addClass('hidden');
                }).on('select2:open', function () {
                    // Focus on search field when dropdown opens
                    setTimeout(() => {
                        $('.select2-search--dropdown .select2-search__field').attr('placeholder', '🔍 Cari tipe HP...');
                    }, 50);
                });

                // Add custom event for better UX
                $('#tipehp').on('select2:select', function (e) {
                    const selection = e.params.data.text;
                    // Show a subtle success indicator
                    $(this).parent().find('.select2-selection').addClass('border-green-400');
                    setTimeout(() => {
                        $(this).parent().find('.select2-selection').removeClass('border-green-400');
                    }, 1000);
                });
            }
        }

        // Google Apps Script URLs
        const scriptURL = "https://script.google.com/macros/s/AKfycbx7br5nZCfXW9xXqY2kZxhg72WxTsxYRAwNoH_UG2NGRo2_JPetYSMklLwmUYuMPT6M/exec";
        const scriptUrl = "https://script.google.com/macros/s/AKfycbyezzdx3xEBF2AvP-tcSZVBBCXaBcdurjJsdj7zk7a_LAuBN2SjrNKkMDAePlOQ3JDz/exec";

        // Main navigation functions
        function showApplication(appType) {
            document.getElementById("mainSelectionScreen").style.display = "none";
            if (appType === 'hp') {
                document.getElementById("hpApplication").style.display = "block";
                AOS.refresh();
            } else if (appType === 'seragam') {
                document.getElementById("seragamApplication").style.display = "block";
                AOS.refresh();
            }
        }

        function backToMainSelection() {
            // Hide all sections
            document.getElementById("mainSelectionScreen").style.display = "block";
            document.getElementById("hpApplication").style.display = "none";
            document.getElementById("hpSearchSection").style.display = "none";
            document.getElementById("hpInputSection").style.display = "none";
            document.getElementById("seragamApplication").style.display = "none";
            document.getElementById("formContainer").style.display = "none";
            AOS.refresh();
        }

        // HP Application functions
        function showHpSection(section) {
            document.getElementById("hpApplication").style.display = "none";
            if (section === 'search') {
                document.getElementById("hpSearchSection").style.display = "block";
            } else if (section === 'input') {
                document.getElementById("hpInputSection").style.display = "block";

                // Re-initialize Select2 when showing input section
                setTimeout(() => {
                    initializeSelect2();

                    // Set today's date as default
                    const today = new Date();
                    $('#tanggal').val(today.toISOString().split('T')[0]);
                }, 100);
            }
            AOS.refresh();
        }

        function backToHpApplication() {
            document.getElementById("hpSearchSection").style.display = "none";
            document.getElementById("hpInputSection").style.display = "none";
            document.getElementById("hpApplication").style.display = "block";
            AOS.refresh();
        }

        // Seragam Application functions
        function navigateTo(formId) {
            document.getElementById("seragamApplication").style.display = "none";
            document.getElementById("formContainer").style.display = "block";
            const sections = ["box-search", "box-seragam", "box-po", "box-surat"];
            sections.forEach(id => document.getElementById(id).style.display = "none");
            document.getElementById(formId).style.display = "block";
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
            // Refresh AOS setelah navigasi
            AOS.refresh();
        }

        function backToSeragamApplication() {
            document.getElementById("formContainer").style.display = "none";
            document.getElementById("seragamApplication").style.display = "block";
            // Scroll to menu section
            document.getElementById("menuSection").scrollIntoView({ behavior: 'smooth' });
            AOS.refresh();
        }

        // Enhanced notification function
        function showNotification(message, isSuccess = true) {
            const notification = $('#notification');
            const icon = $('#notificationIcon');
            const text = $('#notificationText');

            // Set notification content
            text.text(message);

            // Set notification style based on success/error
            if (isSuccess) {
                notification.removeClass('bg-red-500 border-red-400').addClass('bg-green-500 border-green-400');
                icon.removeClass('fa-times-circle fa-exclamation-triangle').addClass('fa-check-circle');
            } else {
                notification.removeClass('bg-green-500 border-green-400').addClass('bg-red-500 border-red-400');
                icon.removeClass('fa-check-circle').addClass('fa-times-circle');
            }

            // Show notification with animation
            notification.removeClass('hidden').removeClass('translate-y-16').addClass('notification-show');

            // Hide notification after 5 seconds
            setTimeout(() => {
                notification.addClass('translate-y-16').removeClass('notification-show');
                setTimeout(() => {
                    notification.addClass('hidden');
                }, 300);
            }, 5000);
        }

        // HP Application functions
        $(document).ready(function () {
            // Search button click handler
            $('#searchBtn').click(searchByNpk);

            // Enter key handler for search
            $('#searchNpk').keypress(function (e) {
                if (e.which === 13) {
                    searchByNpk();
                    e.preventDefault();
                }
            });

            // Form submission handler
            $('#formHP').submit(submitHpForm);

            // Status form submission handler
            $('#statusForm').submit(updateHpStatus);
        });

        // Function to validate phone number
        function validatePhoneNumber(phone) {
            const phoneRegex = /^[0-9]{10,13}$/;
            return phoneRegex.test(phone.replace(/\D/g, ''));
        }

        // Function to search data by NPK
        function searchByNpk() {
            const npk = $('#searchNpk').val().trim();
            const errorElement = $('#searchNpkError');

            // Reset error state
            errorElement.addClass('hidden');
            $('#searchNpk').removeClass('error-input');

            if (!npk) {
                errorElement.removeClass('hidden');
                $('#searchNpk').addClass('error-input');
                return;
            }

            $('#loadingSpinner').removeClass('hidden');

            const searchUrl = `${scriptUrl}?action=getData&npk=${encodeURIComponent(npk)}`;

            fetch(searchUrl)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Gagal menghubungi server');
                    }
                    return response.json();
                })
                .then(data => {
                    if (Array.isArray(data) && data.length > 0) {
                        window.currentSearchData = data;
                        displaySearchResults(data);
                        showNotification(`Ditemukan ${data.length} data untuk NPK ${npk}`);
                    } else {
                        showNotification('Data tidak ditemukan untuk NPK tersebut', false);
                        $('#searchResults').addClass('hidden');
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    showNotification('Gagal mengambil data: ' + error.message, false);
                    $('#searchResults').addClass('hidden');
                })
                .finally(() => {
                    $('#loadingSpinner').addClass('hidden');
                });
        }

        // Display search results in table
        function displaySearchResults(data) {
            const resultsBody = $('#resultsBody');
            resultsBody.empty();

            data.forEach((row, index) => {
                resultsBody.append(`
                    <tr class="hover:bg-yellow-50 transition-colors">
                        <td class="whitespace-nowrap">${formatDateDisplay(row.tanggal)}</td>
                        <td class="font-mono font-semibold">${row.npk || '-'}</td>
                        <td class="whitespace-nowrap">${formatPhoneDisplay(row.notelp)}</td>
                        <td>${row.cicilan || '-'}</td>
                        <td class="max-w-xs truncate" title="${row.tipehp || '-'}">${row.tipehp || '-'}</td>
                        <td class="max-w-xs truncate" title="${row.alamat || '-'}">${row.alamat || '-'}</td>
                        <td class="max-w-xs truncate" title="${row.keterangan || '-'}">${row.keterangan || '-'}</td>
                        <td><span class="status-badge ${getStatusClass(row.status)}">${row.status || '-'}</span></td>
                        <td>
                            <button onclick="openStatusModal(${index}, ${JSON.stringify(row).replace(/"/g, '&quot;')})" 
                                    class="px-3 py-2 bg-blue-500 text-white text-sm rounded-lg hover:bg-blue-600 transition-colors flex items-center">
                                <i class="fas fa-edit mr-1"></i> Ubah
                            </button>
                        </td>
                    </tr>
                `);
            });

            $('#searchResults').removeClass('hidden');
        }

        // Format date for display
        function formatDateDisplay(dateStr) {
            if (!dateStr || dateStr === '-') return '-';

            if (dateStr.includes('/')) {
                const parts = dateStr.split('/');
                if (parts.length === 3) {
                    return `${parts[1].padStart(2, '0')}/${parts[0].padStart(2, '0')}/${parts[2]}`;
                }
            } else if (dateStr.includes('-')) {
                const parts = dateStr.split('-');
                if (parts.length === 3) {
                    return `${parts[2]}/${parts[1]}/${parts[0]}`;
                }
            }

            return dateStr;
        }

        // Format phone number for display
        function formatPhoneDisplay(phone) {
            if (!phone || phone === '-') return '-';

            const cleaned = phone.replace(/\D/g, '');

            if (cleaned.length >= 10) {
                return cleaned.replace(/(\d{4})(\d{4})(\d+)/, '$1-$2-$3');
            }

            return cleaned;
        }

        // Submit HP form data
        function submitHpForm(e) {
            e.preventDefault();

            // Reset all error states
            $('.error-message').addClass('hidden');
            $('input, select, textarea').removeClass('error-input');

            let isValid = true;

            // Validate required fields
            const requiredFields = [
                { id: 'tanggal', errorId: 'tanggalError' },
                { id: 'npk', errorId: 'npkError' },
                { id: 'notelp', errorId: 'notelpError' },
                { id: 'cicilan', errorId: 'cicilanError' },
                { id: 'tipehp', errorId: 'tipehpError' },
                { id: 'alamat', errorId: 'alamatError' },
                { id: 'status', errorId: 'statusError' }
            ];

            requiredFields.forEach(field => {
                const value = $(`#${field.id}`).val().trim();
                if (!value) {
                    $(`#${field.id}`).addClass('error-input');
                    $(`#${field.errorId}`).removeClass('hidden');
                    isValid = false;
                }
            });

            // Validate phone number format
            const phone = $('#notelp').val().trim();
            if (phone && !validatePhoneNumber(phone)) {
                $('#notelp').addClass('error-input');
                $('#notelpError').removeClass('hidden');
                isValid = false;
            }

            // Validate OTHER HP type
            if ($('#tipehp').val() === 'OTHER' && !$('#otherHpInput').val().trim()) {
                $('#otherHpInput').addClass('error-input');
                $('#otherHpError').removeClass('hidden');
                isValid = false;
            }

            if (!isValid) {
                showNotification('Harap periksa kembali form Anda', false);
                return;
            }

            // Prepare form data
            const formData = new FormData(e.target);
            let tipehp = $('#tipehp').val();
            if (tipehp === 'OTHER') tipehp = $('#otherHpInput').val();
            formData.set('tipehp', tipehp);

            // Format phone number with WhatsApp link
            const phoneNumber = formatPhoneInput(phone);
            const waLink = `=HYPERLINK("https://wa.me/${phoneNumber.startsWith('0') ? '62' + phoneNumber.slice(1) : phoneNumber}")`;
            formData.set('notelp', waLink);

            // Format date to MM/DD/YYYY for Google Sheets
            const date = new Date(formData.get('tanggal'));
            formData.set('tanggal', `${date.getMonth() + 1}/${date.getDate()}/${date.getFullYear()}`);

            $('#loadingSpinner').removeClass('hidden');

            fetch(scriptUrl, {
                method: 'POST',
                body: formData
            })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Gagal menghubungi server');
                    }
                    return response.json();
                })
                .then(result => {
                    if (result.error) {
                        throw new Error(result.error);
                    }

                    // Reset form
                    $('#formHP')[0].reset();
                    $('#tipehp').val('').trigger('change');
                    $('#otherHpContainer').addClass('hidden');

                    // Set today's date again
                    const today = new Date();
                    $('#tanggal').val(today.toISOString().split('T')[0]);

                    showNotification('Data HP berhasil dikirim!');
                })
                .catch(error => {
                    console.error('Error:', error);
                    showNotification('Gagal mengirim data: ' + error.message, false);
                })
                .finally(() => {
                    $('#loadingSpinner').addClass('hidden');
                });
        }

        // Format phone number for input field
        function formatPhoneInput(phone) {
            if (!phone) return '';
            return phone.replace(/\D/g, '');
        }

        // Fungsi untuk menampilkan modal ubah status
        function openStatusModal(index, data) {
            const modal = document.getElementById('statusModal');
            document.getElementById('statusId').value = data.id || '';
            document.getElementById('statusRowNumber').value = index;
            document.getElementById('statusNpk').value = data.npk || '-';
            document.getElementById('statusTipeHp').value = data.tipehp || '-';
            document.getElementById('newStatus').value = data.status || '';

            modal.classList.remove('hidden');
        }

        // Fungsi untuk menutup modal
        function closeStatusModal() {
            document.getElementById('statusModal').classList.add('hidden');
        }

        // Fungsi untuk mendapatkan kelas status
        function getStatusClass(status) {
            switch (status) {
                case 'VERIFIKASI':
                    return 'status-verification';
                case 'OK':
                    return 'status-ok';
                case 'NO ACC':
                    return 'status-no-acc';
                case 'CANCEL':
                    return 'status-cancel';
                default:
                    return 'bg-gray-100 text-gray-800';
            }
        }

        // Fungsi untuk update status HP
        function updateHpStatus(e) {
            e.preventDefault();

            const rowNumber = $('#statusRowNumber').val();
            const newStatus = $('#newStatus').val();
            const npk = $('#statusNpk').val();
            const tipehp = $('#statusTipeHp').val();

            if (!newStatus) {
                showNotification('Harap pilih status baru', false);
                return;
            }

            $('#loadingSpinner').removeClass('hidden');

            const formData = new FormData();
            formData.append('action', 'updateStatus');
            formData.append('npk', npk);
            formData.append('tipehp', tipehp);
            formData.append('status', newStatus);

            fetch(scriptUrl, {
                method: 'POST',
                body: formData
            })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Gagal menghubungi server');
                    }
                    return response.json();
                })
                .then(result => {
                    if (result.error) {
                        throw new Error(result.error);
                    }

                    if (window.currentSearchData && window.currentSearchData[rowNumber]) {
                        window.currentSearchData[rowNumber].status = newStatus;
                        displaySearchResults(window.currentSearchData);
                    }

                    closeStatusModal();
                    showNotification('Status berhasil diperbarui!');
                })
                .catch(error => {
                    console.error('Error:', error);
                    showNotification('Gagal memperbarui status: ' + error.message, false);
                })
                .finally(() => {
                    $('#loadingSpinner').addClass('hidden');
                });
        }

        // Seragam Application functions
        document.getElementById('form-seragam').addEventListener('submit', async function (e) {
            e.preventDefault();
            const notif = document.getElementById('notif-seragam');
            const formData = new FormData(e.target);

            // Show loading spinner
            document.getElementById('loadingSpinner').classList.remove('hidden');

            try {
                await fetch(scriptURL, { method: "POST", body: formData });
                notif.textContent = "✅ Data Seragam berhasil dikirim!";
                notif.className = "text-center font-bold mb-6 p-3 rounded-lg bg-green-100 text-green-700";
                e.target.reset();
            } catch (err) {
                notif.textContent = "❌ Gagal mengirim data.";
                notif.className = "text-center font-bold mb-6 p-3 rounded-lg bg-red-100 text-red-700";
            } finally {
                // Hide loading spinner
                document.getElementById('loadingSpinner').classList.add('hidden');
            }
        });

        document.getElementById('form-po').addEventListener('submit', async function (e) {
            e.preventDefault();
            const notif = document.getElementById('notif-po');
            const formData = new FormData(e.target);

            // Show loading spinner
            document.getElementById('loadingSpinner').classList.remove('hidden');

            try {
                await fetch(scriptURL, { method: "POST", body: formData });
                notif.textContent = "✅ Data PO_Seragam berhasil dikirim!";
                notif.className = "text-center font-bold mb-6 p-3 rounded-lg bg-green-100 text-green-700";
                e.target.reset();
            } catch (err) {
                notif.textContent = "❌ Gagal mengirim data.";
                notif.className = "text-center font-bold mb-6 p-3 rounded-lg bg-red-100 text-red-700";
            } finally {
                // Hide loading spinner
                document.getElementById('loadingSpinner').classList.add('hidden');
            }
        });

        document.getElementById('form-search').addEventListener('submit', async function (e) {
            e.preventDefault();
            const notif = document.getElementById('notif-search');
            const resultsContainer = document.getElementById('search-results');
            const formData = new FormData(e.target);
            notif.textContent = "🔍 Mencari data...";
            notif.className = "text-center font-bold mb-6 p-3 rounded-lg bg-blue-100 text-blue-700";
            resultsContainer.innerHTML = "";

            // Show loading spinner
            document.getElementById('loadingSpinner').classList.remove('hidden');

            try {
                const response = await fetch(scriptURL, { method: "POST", body: formData });
                const result = await response.json();
                if (result.status === "success") {
                    notif.textContent = `✅ Ditemukan ${result.count} data`;
                    notif.className = "text-center font-bold mb-6 p-3 rounded-lg bg-green-100 text-green-700";
                    result.data.forEach(item => {
                        const div = document.createElement("div");
                        div.className = "bg-gray-50 p-5 rounded-xl border border-gray-200 shadow-sm";
                        div.innerHTML =
                            `<div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                <div><strong class="text-gray-700">No:</strong> <span class="text-gray-900">${item.no || "-"}</span></div>
                                <div><strong class="text-gray-700">Tanggal:</strong> <span class="text-gray-900">${item.tanggal || "-"}</span></div>
                                <div><strong class="text-gray-700">No. Invoice:</strong> <span class="text-gray-900">${item.no_inv || "-"}</span></div>
                                <div><strong class="text-gray-700">No. PO:</strong> <span class="text-gray-900">${item.no_po || "-"}</span></div>
                                <div><strong class="text-gray-700">Nominal:</strong> <span class="text-gray-900">${item.nominal ? Number(item.nominal).toLocaleString() : "-"}</span></div>
                                <div><strong class="text-gray-700">DPP:</strong> <span class="text-gray-900">${item.dpp ? Number(item.dpp).toLocaleString() : "-"}</span></div>
                                <div><strong class="text-gray-700">DPP9:</strong> <span class="text-gray-900">${item.dpp9 ? Number(item.dpp9).toLocaleString() : "-"}</span></div>
                                <div><strong class="text-gray-700">User:</strong> <span class="text-gray-900">${item.user || "-"}</span></div>
                            </div>`;
                        resultsContainer.appendChild(div);
                    });
                } else {
                    notif.textContent = result.message || "❌ Tidak ditemukan.";
                    notif.className = "text-center font-bold mb-6 p-3 rounded-lg bg-red-100 text-red-700";
                }
            } catch (err) {
                notif.textContent = "❌ Gagal melakukan pencarian.";
                notif.className = "text-center font-bold mb-6 p-3 rounded-lg bg-red-100 text-red-700";
            } finally {
                // Hide loading spinner
                document.getElementById('loadingSpinner').classList.add('hidden');
            }
        });

        function buatInputBarang() {
            const jumlah = document.querySelector('input[name="jumlahBarang"]').value;
            const container = document.getElementById('barangInputs');
            container.innerHTML = "";
            for (let i = 1; i <= jumlah; i++) {
                container.innerHTML +=
                    `<div class="bg-yellow-50 p-5 rounded-xl border border-yellow-200">
                        <h3 class="font-bold text-yellow-700 mb-3 flex items-center">
                            <i class="fas fa-box mr-2"></i> Barang ${i}
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div class="md:col-span-2">
                                <label class="block text-sm font-medium text-gray-700 mb-1">Nama Barang ${i}</label>
                                <input type="text" name="barang${i}" required
                                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Qty ${i}</label>
                                <input type="number" name="qty${i}" required
                                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent">
                            </div>
                        </div>
                        <div class="mt-3">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Satuan ${i}</label>
                            <select name="satuan${i}"
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent">
                                <option value="pcs">pcs</option>
                                <option value="stel">stel</option>
                                <option value="psg">psg</option>
                            </select>
                        </div>
                    </div>`;
            }
        }

        function openPrintWindow(suratData) {
            const printWindow = window.open('', '_blank');
            const printDocument = printWindow.document;
            printDocument.write(
                `<!DOCTYPE html>
                <html lang="en">
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>Surat Jalan</title>
                    <style>
                        body {
                            font-family: Arial, sans-serif;
                            margin: 20px;
                        }
                        .container {
                            display: flex;
                            justify-content: space-between;
                            align-items: flex-start;
                        }
                        .header {
                            font-weight: bold;
                        }
                        .header-koperasi {
                            font-weight: bold;
                        }
                        .alamat {
                            font-style: italic;
                        }
                        .center {
                            text-align: center;
                        }
                        .right {
                            text-align: right;
                        }
                        .signature {
                            text-align: center;
                            margin-top: 20px;
                        }
                        .section-gap {
                            margin-bottom: 10px;
                        }
                        .item-gap {
                            margin-top: 10px;
                        }
                        .koperasi, .surat-jalan {
                            width: 48%;
                            padding: 10px;
                        }
                        .surat-jalan {
                            border: 1px solid black;
                        }
                        table {
                            width: 100%;
                            border-collapse: collapse;
                            margin-top: 20px;
                        }
                        th, td {
                            border: 1px solid black;
                            padding: 8px;
                            text-align: left;
                        }
                        th {
                            background-color: #f2f2f2;
                        }
                        .signature-block td {
                            height: 100px;
                            vertical-align: bottom;
                            text-align: center;
                        }
                    </style>
                </head>
                <body>
                    <div class="container section-gap">
                        <div class="koperasi">
                            <div class="header-koperasi">Koperasi Sigap Nusantara</div>
                            <div>Jl. A. Yani No. 66, RW. 3, Cemp. Putih Timur</div>
                            <div>Kota Jakarta Pusat - 10510</div>
                            <div>(021) 21242525<br>NPWP: 02.250.480.7-408.000</div>
                        </div>
                        <div class="surat-jalan">
                            <p class="header center">Surat Jalan</p>
                            <p style="display: flex; justify-content: space-between; margin: 5px 0;">
                                <span style="width: 70px;">Nomor</span>
                                <span>:</span>
                                <span style="flex: 1; margin-left: 10px;">${suratData.nomor}/SRT/SPA/VII/2025</span>
                            </p>
                            <p style="display: flex; justify-content: space-between; margin: 5px 0;">
                                <span style="width: 70px;">Tanggal</span>
                                <span>:</span>
                                <span style="flex: 1; margin-left: 10px;">${suratData.tanggal}</span>
                            </p>
                            <p style="display: flex; justify-content: space-between; margin: 5px 0;">
                                <span style="width: 70px;">User</span>
                                <span>:</span>
                                <span style="flex: 1; margin-left: 10px;">${suratData.user}</span>
                            </p>
                            <p style="display: flex; justify-content: space-between; margin: 5px 0;">
                                <span style="width: 70px;">No PO</span>
                                <span>:</span>
                                <span style="flex: 1; margin-left: 10px;">${suratData.no_po || ''}</span>
                            </p>
                            <p style="display: flex; justify-content: space-between; margin: 5px 0;">
                                <span style="width: 70px;">Penerima</span>
                                <span>:</span>
                                <span style="flex: 1; margin-left: 10px;"></span>
                            </p>
                        </div>
                    </div>
                    <table style="width: 30%; border-collapse: collapse; border: 1px solid black; margin-top: 20px;">
                        <tr>
                            <td colspan="4" class="alamat center" style="border: 1px solid black; padding: 5px;">Alamat Pengiriman</td>
                        </tr>
                        <tr>
                            <td colspan="4" style="font-weight: bold; border: 1px solid black; padding: 5px;">PT. Sigap Prima Astrea</td>
                        </tr>
                        <tr>
                            <td colspan="4" style="border: 1px solid black; padding: 5px;">Jl. A. Yani No. 66, RW. 3,<br>Cemp. Putih Tim., Kec. Cemp. Putih,</td>
                        </tr>
                        <tr>
                            <td colspan="4" style="border: 1px solid black; padding: 5px;">Kota Jakarta Pusat - 10510</td>
                        </tr>
                    </table>
                    <table style="width: 100%; border-collapse: collapse; border: 1px solid black; margin-top: 20px;">
                        <tr>
                            <td colspan="5" style="border: 1px solid black; padding: 5px;">Harap dikirimkan barang-barang berikut ini:</td>
                        </tr>
                        <tr>
                            <th style="border: 1px solid black; padding: 5px; background-color: #f2f2f2;">No.</th>
                            <th colspan="2" style="border: 1px solid black; padding: 5px; background-color: #f2f2f2;">Nama Barang</th>
                            <th style="border: 1px solid black; padding: 5px; background-color: #f2f2f2;">Qty</th>
                            <th style="border: 1px solid black; padding: 5px; background-color: #f2f2f2;">Satuan</th>
                        </tr>
                        ${suratData.rows}
                        <tr>
                            <td colspan="2" style="border: 1px solid black; padding: 5px; text-align: center; font-weight: bold;">
                                Disiapkan oleh</td>
                            <td style="border: 1px solid black; padding: 5px; text-align: center; font-weight: bold;">Disetujui oleh
                            </td>
                            <td></td>
                            <td style="border: 1px solid black; padding: 5px; text-align: center; font-weight: bold;">Dikonfirmasi oleh
                            </td>
                        </tr>
                        <tr style="font-weight: bold;">
                            <td colspan="2" class="signature" style="border: 1px solid black; padding: 5px; text-align: center;">
                                <br><br><br><br><br>Steven Jefferson<br><span style="font-size: smaller;">Staff Koperasi</span>
                            </td>
                            <td class="signature" style="border: 1px solid black; padding: 5px; text-align: center;">
                                <br><br><br><br><br>Agus Sofyan Effendi<br><span style="font-size: smaller;">Manager Koperasi</span>
                            </td>
                            <td></td>
                            <td class="signature" style="border: 1px solid black; padding: 5px; text-align: center;">
                                <br><br><br><br><br>Customer
                            </td>
                        </tr>
                    </table>
                    <script>
                        window.onload = function() {
                            setTimeout(function() {
                                window.print();
                            }, 500);
                        }
                    <\/script>
                </body>
                </html>`
            );
            printDocument.close();
        }

        function printSurat() {
            const form = document.querySelector('#box-surat form');
            if (!form) {
                alert("Form Surat Jalan tidak ditemukan!");
                return;
            }
            const nomor = form.nomor.value;
            const tanggalInput = form.tanggal.value;
            const user = form.user.value;
            let noPoInput = form.querySelector('input[name="no_po"]');
            if (!noPoInput) {
                noPoInput = document.createElement('input');
                noPoInput.type = 'hidden';
                noPoInput.name = 'no_po';
                form.appendChild(noPoInput);
            }
            const no_po = noPoInput.value;
            const jumlah = parseInt(form.jumlahBarang.value);
            if (!nomor || !tanggalInput || !user || isNaN(jumlah) || jumlah <= 0) {
                alert("Harap isi semua field yang diperlukan dan buat form barang terlebih dahulu.");
                return;
            }
            let tanggalFormatted = "";
            if (tanggalInput) {
                const tanggalObj = new Date(tanggalInput);
                tanggalFormatted = tanggalObj.toLocaleDateString('id-ID', { day: '2-digit', month: 'short', year: 'numeric' });
            }
            let rows = "";
            for (let i = 1; i <= jumlah; i++) {
                const namaInput = form[`barang${i}`];
                const qtyInput = form[`qty${i}`];
                const satuanInput = form[`satuan${i}`];
                if (namaInput && qtyInput && satuanInput) {
                    const nama = namaInput.value;
                    const qty = qtyInput.value;
                    const satuan = satuanInput.value;
                    rows += `<tr>
                                <td style="border: 1px solid black; padding: 5px;">${i}</td>
                                <td colspan="2" style="border: 1px solid black; padding: 5px;">${nama}</td>
                                <td style="border: 1px solid black; padding: 5px;">${qty}</td>
                                <td style="border: 1px solid black; padding: 5px;">${satuan}</td>
                            </tr>`;
                } else {
                    console.warn(`Input barang ${i} tidak ditemukan atau tidak lengkap.`);
                }
            }
            const suratData = {
                nomor: nomor,
                tanggal: tanggalFormatted,
                user: user,
                no_po: no_po,
                rows: rows
            };
            openPrintWindow(suratData);
        }

        document.getElementById("suratForm").addEventListener("submit", function (e) {
            e.preventDefault();
            const form = e.target;
            const nomor = form.nomor.value;
            const tanggal = form.tanggal.value;
            const user = form.user.value;
            let noPoInput = form.querySelector('input[name="no_po"]');
            if (!noPoInput) {
                noPoInput = document.createElement('input');
                noPoInput.type = 'hidden';
                noPoInput.name = 'no_po';
                form.appendChild(noPoInput);
            }
            const no_po = noPoInput.value;
            const jumlah = parseInt(form.jumlahBarang.value);
            let rows = "";
            for (let i = 1; i <= jumlah; i++) {
                const nama = form[`barang${i}`].value;
                const qty = form[`qty${i}`].value;
                const satuan = form[`satuan${i}`].value;
                rows += `<tr><td class="border border-gray-400 p-2">${i}</td><td class="border border-gray-400 p-2">${nama}</td><td class="border border-gray-400 p-2">${qty}</td><td class="border border-gray-400 p-2">${satuan}</td></tr>`;
            }
            document.getElementById("output").innerHTML =
                `<div class="bg-white p-6 rounded-xl shadow-lg">
                    <table class="w-full border-collapse border border-gray-400">
                        <tr>
                            <td colspan="2" class="border border-gray-400 p-4 align-top">
                                <strong class="text-lg text-yellow-600">Koperasi Sigap Nusantara</strong><br>
                                <div class="mt-2 text-gray-700">
                                    Jl. A. Yani No.66, RW.3, Cemp. Putih Timur<br>
                                    Kota Jakarta Pusat - 10510<br>
                                    (021) 2124525<br>
                                    NPWP: 02.250.480.7-408.000
                                </div>
                            </td>
                            <td colspan="2" class="border border-gray-400 p-4 text-right align-top">
                                <strong class="text-lg text-yellow-700">Surat Jalan</strong><br><br>
                                <div class="text-gray-700">
                                    Nomor: ${nomor}<br>
                                    Tanggal: ${tanggal}<br>
                                    User: ${user}<br>
                                    No PO: ${no_po || '-'}
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="4" class="border border-gray-400 p-4 bg-yellow-50">
                                <strong class="text-yellow-700">Alamat Pengiriman</strong><br>
                                <div class="mt-2 text-gray-700">
                                    PT. Sigap Prima Astrea<br>
                                    Jl. A. Yani No.66, RW.3, Cemp. Putih Tim., Kec. Cemp. Putih,<br>
                                    Kota Jakarta Pusat - 10510
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="4" class="border border-gray-400 p-4">
                                Harap dikirimkan barang-barang berikut ini:
                            </td>
                        </tr>
                        <tr>
                            <th class="border border-gray-400 p-2 bg-gray-100">No.</th>
                            <th class="border border-gray-400 p-2 bg-gray-100">Nama Barang</th>
                            <th class="border border-gray-400 p-2 bg-gray-100">Qty</th>
                            <th class="border border-gray-400 p-2 bg-gray-100">Satuan</th>
                        </tr>
                        ${rows}
                        <tr class="signature-block">
                            <td class="border border-gray-400 p-4 h-32 align-bottom text-center">
                                <div class="text-gray-700">Disiapkan oleh</div><br><br>
                                <strong class="text-yellow-600">Steven Jefferson</strong><br>
                                <span class="text-sm text-gray-600">Staff Koperasi</span>
                            </td>
                            <td class="border border-gray-400 p-4 h-32 align-bottom text-center">
                                <div class="text-gray-700">Disetujui oleh</div><br><br>
                                <strong class="text-yellow-600">Agus Sofyan Effendi</strong><br>
                                <span class="text-sm text-gray-600">Manager Koperasi</span>
                            </td>
                            <td colspan="2" class="border border-gray-400 p-4 h-32 align-bottom text-center">
                                <div class="text-gray-700">Dikonfirmasi oleh</div><br><br>
                                <strong class="text-gray-700">________________________</strong><br>
                                <span class="text-sm text-gray-600">Customer</span>
                            </td>
                        </tr>
                    </table>
                </div>`;
            document.getElementById("outputSection").style.display = "block";
            document.getElementById("printButton").style.display = "inline-block";
            document.getElementById("outputSection").scrollIntoView({ behavior: 'smooth' });
        });
    </script>
</body>

</html>
